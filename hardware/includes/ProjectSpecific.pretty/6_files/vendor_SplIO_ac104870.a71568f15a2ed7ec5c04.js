/*! For license information please see vendor~SplIO~ac104870.a71568f15a2ed7ec5c04.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[153],{11244:function(t,e,n){"use strict";n.d(e,"a",(function(){return Vo}));var r=n(423),i=n.n(r),o=function(t){return void 0!==t&&null!==t&&"function"===typeof t.then},a=n(350),s=n(312),c=Object(s.b)("",{displayAllErrors:!0}),u={};function l(t){u[t]&&u[t]--,0===u[t]&&delete u[t]}var f=Object(s.b)("");var h=Object(s.b)(""),p=/^[a-zA-Z0-9][-_.:a-zA-Z0-9]{0,79}$/;function g(t,e){if(void 0==t)h.error("".concat(e,": you passed a null or undefined event_type, event_type must be a non-empty string."));else if(Object(a.j)(t))if(0===t.length)h.error("".concat(e,": you passed an empty event_type, event_type must be a non-empty string."));else{if(p.test(t))return t;h.error("".concat(e,': you passed "').concat(t,'", event_type must adhere to the regular expression /^[a-zA-Z0-9][-_.:a-zA-Z0-9]{0,79}$/g. This means an event_type must be alphanumeric, cannot be more than 80 characters long, and can only include a dash, underscore, period, or colon as separators of alphanumeric characters.'))}else h.error("".concat(e,": you passed an invalid event_type, event_type must be a non-empty string."));return!1}var d=Object(s.b)("");function v(t,e){return Object(a.l)(t)||void 0==t?t:(d.error("".concat(e,": value must be a finite number.")),!1)}var m=Object(s.b)(""),y=0,b=2,S=4,T=8,E=1024;function O(t,e){if(void 0==t)return{properties:null,size:E};if(!Object(a.i)(t))return m.error("".concat(e,": properties must be a plain object.")),{properties:!1,size:E};var n=Object.keys(t),r=Object(a.n)(t),i={properties:r,size:E};n.length>300&&m.warn("".concat(e,": Event has more than 300 properties. Some of them will be trimmed when processed."));for(var o=0;o<n.length;o++){i.size+=n[o].length*b;var s=r[n[o]],c=Object(a.j)(s),u=Object(a.l)(s),l=Object(a.h)(s),f=null===s;if(c||u||l||f||(r[n[o]]=null,s=null,f=!0,m.warn("".concat(e,": Property ").concat(n[o]," is of invalid type. Setting value to null."))),f?i.size+=y:u?i.size+=T:l?i.size+=S:c&&(i.size+=s.length*b),i.size>32768){m.error("".concat(e,": The maximum size allowed for the properties is 32768 bytes, which was exceeded. Event not queued.")),i.properties=!1;break}}return i}var _=Object(s.b)("");function k(t,e,n){if(void 0==t)return _.error("".concat(e,": you passed a null or undefined ").concat(n,", ").concat(n," must be a non-empty string.")),!1;if(Object(a.l)(t))return _.warn("".concat(e,": ").concat(n,' "').concat(t,'" is not of type string, converting.')),Object(a.q)(t);if(Object(a.j)(t)){if((t=t.trim()).length>0&&t.length<=250)return t;0===t.length?_.error("".concat(e,": you passed an empty string, ").concat(n," must be a non-empty string.")):t.length>250&&_.error("".concat(e,": ").concat(n," too long, ").concat(n," must be 250 characters or less."))}else _.error("".concat(e,": you passed an invalid ").concat(n," type, ").concat(n," must be a non-empty string."));return!1}function N(t,e){if(Object(a.i)(t)){var n=k(t.matchingKey,e,"matchingKey"),r=k(t.bucketingKey,e,"bucketingKey");return n&&r?{matchingKey:n,bucketingKey:r}:(_.error("".concat(e,": Key must be an object with bucketingKey and matchingKey with valid string properties.")),!1)}return k(t,e,"key")}var A="definition not found",R="exception",w=Object(s.b)(""),I=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/;function C(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"split name";if(void 0==t)w.error("".concat(e,": you passed a null or undefined ").concat(n,", ").concat(n," must be a non-empty string."));else if(Object(a.j)(t)){if(I.test(t)&&(w.warn("".concat(e,": ").concat(n,' "').concat(t,'" has extra whitespace, trimming.')),t=t.trim()),t.length>0)return t;w.error("".concat(e,": you passed an empty ").concat(n,", ").concat(n," must be a non-empty string."))}else w.error("".concat(e,": you passed an invalid ").concat(n,", ").concat(n," must be a non-empty string."));return!1}function j(t,e,n,r){return!t.get(t.constants.READY,!0)||n!==A&&null!=n||(w.warn("".concat(r,': you passed "').concat(e,'" that does not exist in this environment, please double check what Splits exist in the web console.')),!1)}var D=Object(s.b)("");function L(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"split_names",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"split name";if(Array.isArray(t)&&t.length>0){var i=[];if(t.forEach((function(t){var n=C(t,e,r);n&&i.push(n)})),i.length)return Object(a.s)(i)}return D.error("".concat(e,": ").concat(n," must be a non-empty array.")),!1}var M="localhost",P="standalone",F="producer",K="consumer",x="MEMORY",U="LOCALSTORAGE",G="control",H={treatment:G,config:null},W="GOOGLE_ANALYTICS_TO_SPLIT",B="SPLIT_TO_GOOGLE_ANALYTICS",Y="IMPRESSION",q="EVENT",z=[{type:"byName",maxLength:400,queryParam:"names="},{type:"byPrefix",maxLength:50,queryParam:"prefixes="}],Q="DEBUG",V="OPTIMIZED",J=Object(s.b)(""),$=/[A-Z]/;function Z(t,e){if(void 0==t)J.error("".concat(e,": you passed a null or undefined traffic_type_name, traffic_type_name must be a non-empty string."));else if(Object(a.j)(t)){if(0!==t.length)return $.test(t)&&(J.warn("".concat(e,": traffic_type_name should be all lowercase - converting string to lowercase.")),t=t.toLowerCase()),t;J.error("".concat(e,": you passed an empty traffic_type_name, traffic_type_name must be a non-empty string."))}else J.error("".concat(e,": you passed an invalid traffic_type_name, traffic_type_name must be a non-empty string."));return!1}function X(t,e){J.warn("".concat(t,": Traffic Type ").concat(e," does not have any corresponding Splits in this environment, make sure you're tracking your events to a valid traffic type defined in the Split console."))}function tt(t,e,n){var r=e.get(e.constants.READY,!0),i=e.get(e.constants.SETTINGS),a=e.get(e.constants.STORAGE).splits;if(!r||i.mode===M)return!0;var s=a.trafficTypeExists(t);return o(s)?s.then((function(e){return e||X(n,t),e})):s||X(n,t),s}var et=Object(s.b)("",{displayAllErrors:!0});function nt(t){return!t.get(t.constants.DESTROYED,!0)||(et.error("Client has already been destroyed - no calls possible."),!1)}function rt(t,e){return!(!t.get(t.constants.READY,!0)&&!t.get(t.constants.READY_FROM_CACHE,!0))||(et.warn("".concat(e,": the SDK is not ready, results may be incorrect. Make sure to wait for SDK readiness before using this method.")),!1)}var it=function(t){var e=t.conditions,n=Object(a.b)(e,(function(t){return"ROLLOUT"===t.conditionType}));return n||(n=e[0]),n?n.partitions.map((function(t){return t.treatment})):[]},ot=function(t){var e;try{e=JSON.parse(t)}catch(t){return null}return null==e?null:{name:e.name,trafficType:e.trafficTypeName||null,killed:e.killed,changeNumber:e.changeNumber||0,treatments:it(e),configs:e.configurations||{}}},at=function(t){var e=[];return t.forEach((function(t){var n=ot(t);null!=n&&e.push(n)})),e};var st=function(t,e){var n="split",r=e.get(e.constants.STATUS_MANAGER);return i()(Object.create(r),{split:function(r){var i=C(r,n);if(!nt(e)||!rt(e,n)||!i)return null;var a=t.getSplit(i);return o(a)?a.then((function(t){return j(e,i,t,n),ot(t)})):(j(e,i,a,n),ot(a))},splits:function(){if(!nt(e)||!rt(e,"splits"))return[];var n=t.getAll();return o(n)?n.then(at):at(n)},names:function(){return nt(e)&&rt(e,"names")?t.getKeys():[]}})},ct=n(524),ut=n(556);var lt=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=0;e<t.length;e++)for(var n=t[e].matcherGroup.matchers,r=0;r<n.length;r++)if("IN_SEGMENT"===n[r].matcherType)return!0;return!1};function ft(t,e,n){var r=this,i=this.getSplit(t);return(o(i)?i:Promise.resolve(i)).then((function(i){if(i){var o=JSON.parse(i);if(!o.changeNumber||o.changeNumber<n){o.killed=!0,o.defaultTreatment=e,o.changeNumber=n;var a=JSON.stringify(o);return r.addSplit(t,a)}}return!1}))}var ht=function(){function t(){Object(ct.a)(this,t),this.flush()}return Object(ut.a)(t,[{key:"addSplit",value:function(t,e){var n=this.getSplit(t);if(n){var r=JSON.parse(n);if(r.trafficTypeName){var i=r.trafficTypeName;this.ttCache[i]--,this.ttCache[i]||delete this.ttCache[i]}lt(r.conditions)&&this.splitsWithSegmentsCount--}var o=JSON.parse(e);if(o){this.splitCache[t]=e;var a=o.trafficTypeName;return a&&(this.ttCache[a]||(this.ttCache[a]=0),this.ttCache[a]++),lt(o.conditions)&&this.splitsWithSegmentsCount++,!0}return!1}},{key:"addSplits",value:function(t){var e=this,n=[];return t.forEach((function(t){n.push(e.addSplit(t[0],t[1]))})),n}},{key:"removeSplit",value:function(t){var e=this.getSplit(t);if(e){delete this.splitCache[t];var n=JSON.parse(e),r=n.trafficTypeName;return r&&(this.ttCache[r]--,this.ttCache[r]||delete this.ttCache[r]),lt(n.conditions)&&this.splitsWithSegmentsCount--,1}return 0}},{key:"removeSplits",value:function(t){var e=this;return t.forEach((function(t){return e.removeSplit(t)})),t.length}},{key:"getSplit",value:function(t){return this.splitCache[t]}},{key:"setChangeNumber",value:function(t){return this.changeNumber=t,!0}},{key:"getChangeNumber",value:function(){return this.changeNumber}},{key:"getAll",value:function(){var t=this;return this.getKeys().map((function(e){return t.splitCache[e]}))}},{key:"getKeys",value:function(){return Object.keys(this.splitCache)}},{key:"trafficTypeExists",value:function(t){return Object(a.l)(this.ttCache[t])&&this.ttCache[t]>0}},{key:"usesSegments",value:function(){return-1===this.getChangeNumber()||this.splitsWithSegmentsCount>0}},{key:"flush",value:function(){this.splitCache={},this.ttCache={},this.changeNumber=-1,this.splitsWithSegmentsCount=0}},{key:"fetchMany",value:function(t){var e=this,n={};return t.forEach((function(t){n[t]=e.splitCache[t]||null})),n}},{key:"checkCache",value:function(){return!1}}]),t}();ht.prototype.killLocally=ft;var pt=ht,gt=Object(s.b)("splitio-storage:localstorage"),dt=function(){function t(e,n,r){Object(ct.a)(this,t),this.keys=e,this.splitFiltersValidation=r,this.__checkExpiration(n),this.__checkFilterQuery()}return Object(ut.a)(t,[{key:"decrementCount",value:function(t){var e=Object(a.p)(localStorage.getItem(t))-1;e>0?localStorage.setItem(t,e):localStorage.removeItem(t)}},{key:"decrementCounts",value:function(t){try{if(t){if(t.trafficTypeName){var e=this.keys.buildTrafficTypeKey(t.trafficTypeName);this.decrementCount(e)}if(lt(t.conditions)){var n=this.keys.buildSplitsWithSegmentCountKey();this.decrementCount(n)}}}catch(t){gt.error(t)}}},{key:"incrementCounts",value:function(t){try{if(t){if(t.trafficTypeName){var e=this.keys.buildTrafficTypeKey(t.trafficTypeName);localStorage.setItem(e,Object(a.p)(localStorage.getItem(e))+1)}if(lt(t.conditions)){var n=this.keys.buildSplitsWithSegmentCountKey();localStorage.setItem(n,Object(a.p)(localStorage.getItem(n))+1)}}}catch(t){gt.error(t)}}},{key:"addSplit",value:function(t,e){try{var n=this.keys.buildSplitKey(t),r=localStorage.getItem(n),i=r?JSON.parse(r):null;this.decrementCounts(i),localStorage.setItem(n,e);var o=e?JSON.parse(e):null;return this.incrementCounts(o),!0}catch(t){return gt.error(t),!1}}},{key:"addSplits",value:function(t){var e=this,n=[];return t.forEach((function(t){n.push(e.addSplit(t[0],t[1]))})),n}},{key:"removeSplit",value:function(t){try{var e=this.getSplit(t);localStorage.removeItem(this.keys.buildSplitKey(t));var n=JSON.parse(e);return this.decrementCounts(n),1}catch(t){return gt.error(t),0}}},{key:"removeSplits",value:function(t){for(var e=0,n=t.length,r=0;e<n;e++)r+=this.removeSplit(t[e]);return r}},{key:"getSplit",value:function(t){return localStorage.getItem(this.keys.buildSplitKey(t))}},{key:"setChangeNumber",value:function(t){if(this.cacheReadyButNeedsToFlush&&(this.flush(),this.cacheReadyButNeedsToFlush=!1),this.updateNewFilter){gt.info("Split filter query was modified. Updating cache.");var e=this.keys.buildSplitsFilterQueryKey(),n=this.splitFiltersValidation.queryString;try{n?localStorage.setItem(e,n):localStorage.removeItem(e)}catch(t){gt.error(t)}this.updateNewFilter=!1}try{return localStorage.setItem(this.keys.buildSplitsTillKey(),t+""),localStorage.setItem(this.keys.buildLastUpdatedKey(),Date.now()+""),this.hasSync=!0,!0}catch(t){return gt.error(t),!1}}},{key:"getChangeNumber",value:function(){var t=localStorage.getItem(this.keys.buildSplitsTillKey());return null!==t?(t=parseInt(t,10),Object(a.m)(t)?-1:t):-1}},{key:"getAll",value:function(){for(var t=localStorage.length,e=[],n=0;n<t;){var r=localStorage.key(n),i=r&&localStorage.getItem(r);null!=r&&this.keys.isSplitKey(r)&&i&&e.push(i),n++}return e}},{key:"getKeys",value:function(){for(var t=localStorage.length,e=[],n=0;n<t;){var r=localStorage.key(n);null!=r&&this.keys.isSplitKey(r)&&e.push(this.keys.extractKey(r)),n++}return e}},{key:"trafficTypeExists",value:function(t){var e=Object(a.p)(localStorage.getItem(this.keys.buildTrafficTypeKey(t)));return Object(a.l)(e)&&e>0}},{key:"usesSegments",value:function(){if(!this.hasSync)return!0;var t=localStorage.getItem(this.keys.buildSplitsWithSegmentCountKey()),e=null===t?0:Object(a.p)(t);return!Object(a.l)(e)||e>0}},{key:"flush",value:function(){gt.info("Flushing Splits data from localStorage");for(var t=localStorage.length,e=[],n=0;n<t;n++){var r=localStorage.key(n);null!=r&&this.keys.isSplitCacheKey(r)&&e.push(r)}e.forEach((function(t){localStorage.removeItem(t)})),this.hasSync=!1}},{key:"fetchMany",value:function(t){var e=this,n={};return t.forEach((function(t){n[t]=localStorage.getItem(e.keys.buildSplitKey(t))})),n}},{key:"checkCache",value:function(){return this.getChangeNumber()>-1||this.cacheReadyButNeedsToFlush}},{key:"__checkExpiration",value:function(t){var e=localStorage.getItem(this.keys.buildLastUpdatedKey());null!==e&&(e=parseInt(e,10),!Object(a.m)(e)&&e<t&&this.flush())}},{key:"__checkFilterQuery",value:function(){var t=this,e=this.splitFiltersValidation,n=e.queryString,r=e.groupedFilters,i=this.keys.buildSplitsFilterQueryKey();if(localStorage.getItem(i)!==n)try{this.updateNewFilter=!0,this.checkCache()&&(localStorage.setItem(this.keys.buildSplitsTillKey(),"-1"),this.getKeys().forEach((function(e){n&&(r.byName.indexOf(e)>-1||r.byPrefix.some((function(t){return e.startsWith(t+"__")})))?t.cacheReadyButNeedsToFlush=!0:t.removeSplit(e)})))}catch(t){gt.error(t)}}}]),t}();dt.prototype.killLocally=ft;var vt=dt,mt=function(){function t(e){Object(ct.a)(this,t),this.keys=e,this.flush()}return Object(ut.a)(t,[{key:"flush",value:function(){this.segmentCache={}}},{key:"addToSegment",value:function(t){var e=this.keys.buildSegmentNameKey(t);return this.segmentCache[e]=!0,!0}},{key:"removeFromSegment",value:function(t){var e=this.keys.buildSegmentNameKey(t);return delete this.segmentCache[e],!0}},{key:"resetSegments",value:function(t){var e,n=this,r=!1,i=Object.keys(this.segmentCache);if(0===t.length&&i.length===t.length)return r;if(i.length!==t.length)r=!0,this.segmentCache={},t.forEach((function(t){n.addToSegment(t)}));else{for(e=0;e<t.length&&this.isInSegment(t[e]);e++);e<t.length&&(r=!0,this.segmentCache={},t.forEach((function(t){n.addToSegment(t)})))}return r}},{key:"isInSegment",value:function(t){var e=this.keys.buildSegmentNameKey(t);return!0===this.segmentCache[e]}},{key:"setChangeNumber",value:function(){return!0}},{key:"getChangeNumber",value:function(){return-1}},{key:"registerSegment",value:function(){return!1}},{key:"registerSegments",value:function(){return!1}},{key:"getRegisteredSegments",value:function(){return[]}}]),t}(),yt=Object(s.b)("splitio-storage:localstorage"),bt=function(){function t(e){Object(ct.a)(this,t),this.keys=e}return Object(ut.a)(t,[{key:"addToSegment",value:function(t){var e=this.keys.buildSegmentNameKey(t);try{return localStorage.setItem(e,"1"),!0}catch(t){return yt.error(t),!1}}},{key:"removeFromSegment",value:function(t){var e=this.keys.buildSegmentNameKey(t);try{return localStorage.removeItem(e),!0}catch(t){return yt.error(t),!1}}},{key:"resetSegments",value:function(t){var e,n=this,r=!1,i=Object.keys(localStorage).reduce((function(t,e){var r=n.keys.extractSegmentName(e);return r&&t.push(r),t}),[]);if(0===t.length&&i.length===t.length)return r;if(i.length!==t.length)r=!0,i.forEach((function(t){return n.removeFromSegment(t)})),t.forEach((function(t){return n.addToSegment(t)}));else{for(e=0;e<t.length&&-1!==i.indexOf(t[e]);e++);e<t.length&&(r=!0,i.forEach((function(t){return n.removeFromSegment(t)})),t.forEach((function(t){return n.addToSegment(t)})))}return r}},{key:"isInSegment",value:function(t){return"1"===localStorage.getItem(this.keys.buildSegmentNameKey(t))}},{key:"setChangeNumber",value:function(){return!0}},{key:"getChangeNumber",value:function(){return-1}},{key:"registerSegment",value:function(){return!1}},{key:"registerSegments",value:function(){return!1}},{key:"getRegisteredSegments",value:function(){return[]}},{key:"flush",value:function(){yt.info("Flushing MySegments data from localStorage"),this.resetSegments([])}}]),t}();function St(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Tt(t){return function(t){if(Array.isArray(t))return St(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"===typeof t)return St(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?St(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Et=function(){function t(){Object(ct.a)(this,t),this.queue=[]}return Object(ut.a)(t,[{key:"state",value:function(){return this.queue}},{key:"track",value:function(t){var e;return(e=this.queue).push.apply(e,Tt(t)),this}},{key:"clear",value:function(){return this.queue.length=0,this}},{key:"toJSON",value:function(){return this.queue}},{key:"isEmpty",value:function(){return 0===this.queue.length}}]),t}();var Ot=function(t,e){for(var n=0,r=t.length-1,i=Math.floor((r+n)/2),o=n,a=r;t[i]!==e&&n<r;)e<t[i]?r=i-1:e>t[i]&&(n=i+1),i=Math.floor((r+n)/2);return i<o?i=o:i>a&&(i=a),e<t[i]&&i>o?i-1:i}.bind(null,[1,1.5,2.25,3.38,5.06,7.59,11.39,17.09,25.63,38.44,57.67,86.5,129.75,194.62,291.93,437.89,656.84,985.26,1477.89,2216.84,3325.26,4987.89,7481.83]),_t=function(){function t(){Object(ct.a)(this,t),this.clear()}return Object(ut.a)(t,[{key:"clear",value:function(){return this.counters={},this}},{key:"state",value:function(){return this.counters}},{key:"track",value:function(t,e){return void 0===this.counters[t]&&(this.counters[t]=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.counters[t][Ot(e)]++,this}},{key:"isEmpty",value:function(){return 0===Object.keys(this.counters).length}},{key:"toJSON",value:function(){return this.counters}}]),t}(),kt=function(){function t(){Object(ct.a)(this,t),this.clear()}return Object(ut.a)(t,[{key:"clear",value:function(){return this.counters={},this}},{key:"state",value:function(){return this.counters}},{key:"track",value:function(t){return void 0===this.counters[t]?this.counters[t]=1:this.counters[t]++,this.counters[t]}},{key:"isEmpty",value:function(){return 0===Object.keys(this.counters).length}},{key:"toJSON",value:function(){return this.counters}}]),t}(),Nt=function(){function t(e){var n=this;Object(ct.a)(this,t);var r=e.get(e.constants.SETTINGS),i=e.get(e.constants.EVENTS);this.onFullQueue=!1,this.maxQueue=r.scheduler.eventsQueueSize,this.queue=[],this.queueByteSize=0,o(i)?i.then((function(t){n.onFullQueue=t.flushAndResetTimer,n._checkForFlush()})):"function"===typeof i.flushAndResetTimer&&(this.onFullQueue=i.flushAndResetTimer)}return Object(ut.a)(t,[{key:"state",value:function(){return this.queue}},{key:"track",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.queueByteSize+=e,this.queue.push(t),this._checkForFlush(),!0}},{key:"clear",value:function(){return this.queue=[],this.queueByteSize=0,this}},{key:"toJSON",value:function(){return this.queue}},{key:"isEmpty",value:function(){return 0===this.queue.length}},{key:"_checkForFlush",value:function(){(this.queueByteSize>5242880||this.maxQueue>0&&this.queue.length>=this.maxQueue)&&this.onFullQueue&&this.onFullQueue()}}]),t}(),At=/[^.]+$/,Rt=/count\.([^/]+)$/,wt=/latency\.([^/]+)\.bucket\.([0-9]+)$/,It=function(){function t(e){Object(ct.a)(this,t),this.settings=e}return Object(ut.a)(t,[{key:"buildSplitKey",value:function(t){return"".concat(this.settings.storage.prefix,".split.").concat(t)}},{key:"buildTrafficTypeKey",value:function(t){return"".concat(this.settings.storage.prefix,".trafficType.").concat(t)}},{key:"buildSplitsTillKey",value:function(){return"".concat(this.settings.storage.prefix,".splits.till")}},{key:"buildSplitsReady",value:function(){return"".concat(this.settings.storage.prefix,".splits.ready")}},{key:"isSplitKey",value:function(t){return Object(a.o)(t,"".concat(this.settings.storage.prefix,".split."))}},{key:"buildSegmentNameKey",value:function(t){return"".concat(this.settings.storage.prefix,".segment.").concat(t)}},{key:"buildSegmentTillKey",value:function(t){return"".concat(this.settings.storage.prefix,".segment.").concat(t,".till")}},{key:"buildRegisteredSegmentsKey",value:function(){return"".concat(this.settings.storage.prefix,".segments.registered")}},{key:"buildSegmentsReady",value:function(){return"".concat(this.settings.storage.prefix,".segments.ready")}},{key:"buildVersionablePrefix",value:function(){return"".concat(this.settings.storage.prefix,"/").concat(this.settings.version,"/").concat(this.settings.runtime.ip)}},{key:"buildImpressionsKey",value:function(){return"".concat(this.settings.storage.prefix,".impressions")}},{key:"buildEventsKey",value:function(){return"".concat(this.settings.storage.prefix,".events")}},{key:"buildLatencyKeyPrefix",value:function(){return"".concat(this.buildVersionablePrefix(),"/latency")}},{key:"buildLatencyKey",value:function(t,e){return"".concat(this.buildLatencyKeyPrefix(),".").concat(t,".bucket.").concat(e)}},{key:"buildCountKey",value:function(t){return"".concat(this.buildVersionablePrefix(),"/count.").concat(t)}},{key:"buildGaugeKey",value:function(t){return"".concat(this.buildVersionablePrefix(),"/gauge.").concat(t)}},{key:"searchPatternForCountKeys",value:function(){return"".concat(this.buildVersionablePrefix(),"/count.*")}},{key:"searchPatternForSplitKeys",value:function(){return"".concat(this.settings.storage.prefix,".split.*")}},{key:"searchPatternForLatency",value:function(){return"".concat(this.buildLatencyKeyPrefix(),".*")}},{key:"extractKey",value:function(t){var e=t.match(At);if(e&&e.length)return e[0];throw"Invalid latency key provided"}},{key:"extractCounterName",value:function(t){var e=t.match(Rt);if(e&&e.length)return e[1];throw"Invalid counter key provided"}},{key:"extractLatencyMetricNameAndBucket",value:function(t){var e=t.match(wt);if(e&&e.length>2)return{metricName:e[1],bucketNumber:e[2]};throw"Invalid counter key provided"}}]),t}(),Ct=n(461);function jt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Object(Ct.a)(t,e)}var Dt=n(4738),Lt=n.n(Dt),Mt=n(888);function Pt(t,e){return!e||"object"!==Lt()(e)&&"function"!==typeof e?Object(Mt.a)(t):e}function Ft(t){return(Ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kt(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){return Object(a.i)(n)?n[t]:e?void 0:n}}var xt=Kt("matchingKey"),Ut=Kt("bucketingKey",!0);function Gt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ft(t);if(e){var i=Ft(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Pt(this,n)}}var Ht=function(t){jt(n,t);var e=Gt(n);function n(t){var r;return Object(ct.a)(this,n),(r=e.call(this,t)).regexSplitCacheKey=new RegExp("^".concat(r.settings.storage.prefix,"\\.(splits?|trafficType)\\.")),r}return Object(ut.a)(n,[{key:"buildSegmentNameKey",value:function(t){return"".concat(xt(this.settings.core.key),".").concat(this.settings.storage.prefix,".segment.").concat(t)}},{key:"extractSegmentName",value:function(t){var e="".concat(xt(this.settings.core.key),".").concat(this.settings.storage.prefix,".segment.");if(Object(a.o)(t,e))return t.substr(e.length)}},{key:"buildSplitsWithSegmentCountKey",value:function(){return"".concat(this.settings.storage.prefix,".splits.usingSegments")}},{key:"buildLastUpdatedKey",value:function(){return"".concat(this.settings.storage.prefix,".splits.lastUpdated")}},{key:"isSplitCacheKey",value:function(t){return this.regexSplitCacheKey.test(t)}},{key:"buildSplitsFilterQueryKey",value:function(){return"".concat(this.settings.storage.prefix,".splits.filterQuery")}}]),n}(It),Wt=function(t){var e=t.get(t.constants.SETTINGS);switch(e.storage.type){case x:var n=new It(e);return{splits:new pt,segments:new mt(n),impressions:new Et,metrics:new _t,count:new kt,events:new Nt(t),shared:function(t){var e=new It(t);return{splits:this.splits,segments:new mt(e),impressions:this.impressions,metrics:this.metrics,count:this.count,events:this.events,destroy:function(){this.splits=new pt,this.segments.flush()}}},destroy:function(){this.splits.flush(),this.segments.flush(),this.impressions.clear(),this.metrics.clear(),this.count.clear(),this.events.clear()}};case U:var r=new Ht(e),i=Date.now()-864e6;return{splits:new vt(r,i,e.sync.__splitFiltersValidation),segments:new bt(r),impressions:new Et,metrics:new _t,count:new kt,events:new Nt(t),shared:function(t){var e=new Ht(t);return{splits:this.splits,segments:new bt(e),impressions:this.impressions,metrics:this.metrics,count:this.count,events:this.events,destroy:function(){this.splits=new pt,this.segments=new mt(e)}}},destroy:function(){this.splits=new pt,this.segments=new mt(new It(e)),this.impressions.clear(),this.metrics.clear(),this.count.clear(),this.events.clear()}};default:throw new Error("Unsupported storage type")}},Bt=n(2789),Yt=n.n(Bt),qt="init::timeout",zt="init::ready",Qt="init::cache-ready",Vt="state::splits-arrived",Jt="state::segments-arrived",$t="state::splits-cache-loaded",Zt="state::update",Xt="state::check";var te=function(){var t=0,e=new Yt.a;e.SDK_SPLITS_CACHE_LOADED=$t,e.SDK_SPLITS_ARRIVED=Vt;var n=0;function r(e,n){var r=new Yt.a,i=0,o=0;return r.on(Xt,(function(){14!==o&&t+i===6?(o=14,r.emit(zt)):14===o&&r.emit(Zt)})),e.on(Vt,(function(e){e||(t=2),r.emit(Xt)})),e.once($t,(function(){setTimeout((function(){return r.emit(Qt)}),0)})),n.on(Jt,(function(){i=4,r.emit(Xt)})),r}return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=0,o=new Yt.a;o.SDK_SEGMENTS_ARRIVED=Jt;var a=r(e,o);return t>0&&(i=setTimeout((function(){a.emit(qt,"Split SDK emitted SDK_READY_TIMED_OUT event.")}),t),a.once(zt,(function(){return clearTimeout(i)}))),a.SDK_READY=zt,a.SDK_READY_FROM_CACHE=Qt,a.SDK_UPDATE=Zt,a.SDK_READY_TIMED_OUT=qt,n++,{splits:e,segments:o,gate:a,destroy:function(){o.removeAllListeners(),a.removeAllListeners(),clearTimeout(i),n>0&&n--,0===n&&e.removeAllListeners()}}}},ee={startup:{requestTimeoutBeforeReady:5,retriesOnFailureBeforeReady:1,readyTimeout:10,eventsFirstPushWindow:10}},ne=n(4043),re=Object(s.b)("splitio-settings"),ie=function(t){var e=t.mode,n=t.storage,r=n.type,i=void 0===r?x:r,o=n.options,a=void 0===o?{}:o,s=n.prefix;return s?s+=".SPLITIO":s="SPLITIO",e===M?{type:x,prefix:s}:((i!==x&&i!==U||i===U&&!Object(ne.a)())&&(i=x,re.warn("Invalid or unavailable storage. Fallbacking into MEMORY storage")),{type:i,options:a,prefix:s})},oe=Object(s.b)("splitio-settings"),ae=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=t.integrations;if(!Array.isArray(n)||0===n.length)return[];var r=n.filter((function(t){return t&&Object(a.j)(t.type)&&e.indexOf(t.type)>-1})),i=n.length-r.length;return i&&oe.warn("".concat(i," integration ").concat(1===i?"item":"items"," at settings ").concat(1===i?"is":"are"," invalid: integration items must have a valid 'type' value")),r},se=function(t){return ae(t,[W,B])};var ce=function(t,e){if("localhost"===t)return M;if(-1===[P,F,K].indexOf(e))throw Error("Invalid mode provided");return e},ue=Object(s.b)("");function le(t,e){var n={validFilters:[],queryString:null,groupedFilters:{}};return t?e!==P?(ue.warn("Factory instantiation: split filters have been configured but will have no effect if mode is not '".concat(P,"', since synchronization is being deferred to an external tool.")),n):Array.isArray(t)&&0!==t.length?(z.forEach((function(t){n.groupedFilters[t.type]=[]})),n.validFilters=t.filter((function(t,e){return t&&(r=t.type,z.some((function(t){return t.type===r})))&&Array.isArray(t.values)?(n.groupedFilters[t.type]=n.groupedFilters[t.type].concat(t.values),!0):(ue.warn("Factory instantiation: split filter at position '".concat(e,"' is invalid. It must be an object with a valid filter type ('byName' or 'byPrefix') and a list of 'values'.")),!1);var r})),z.forEach((function(t){var e=t.type,r=t.maxLength;n.groupedFilters[e].length>0&&(n.groupedFilters[e]=function(t,e,n){var r=L(e,"Factory instantiation","".concat(t," filter"),"".concat(t," filter value"));if(r){if(r.length>n)throw new Error("".concat(n," unique values can be specified at most for '").concat(t,"' filter. You passed ").concat(r.length,". Please consider reducing the amount or using other filter."));r.sort()}return r||[]}(e,n.groupedFilters[e],r))})),n.queryString=function(t){var e=[];return z.forEach((function(n){var r=n.type,i=n.queryParam,o=t[r];o.length>0&&e.push(i+o.map((function(t){return encodeURIComponent(t)})).join(","))})),e.length>0?"&"+e.join("&"):null}(n.groupedFilters),ue.debug("Factory instantiation: splits filtering criteria is '".concat(n.queryString,"'.")),n):(ue.warn("Factory instantiation: splitFilters configuration must be a non-empty array of filter objects."),n):n}var fe=Object(s.b)("splitio-settings");var he=function(t){return t=t.toUpperCase(),-1===[Q,V].indexOf(t)&&(fe.error("You passed an invalid impressionsMode, impressionsMode should be one of the following values: '".concat(Q,"' or '").concat(V,"'. Defaulting to '").concat(V,"' mode.")),t=V),t},pe=/^\/(testImpressions|metrics|events)/,ge=/^\/auth/,de=/^\/(sse|event-stream)/,ve={mode:P,core:{authorizationKey:void 0,key:void 0,trafficType:void 0,labelsEnabled:!0,IPAddressesEnabled:void 0},scheduler:{featuresRefreshRate:30,segmentsRefreshRate:60,metricsRefreshRate:120,impressionsRefreshRate:60,offlineRefreshRate:15,eventsPushRate:60,eventsQueueSize:500,authRetryBackoffBase:1,streamingReconnectBackoffBase:1},urls:{sdk:"https://sdk.split.io/api",events:"https://events.split.io/api",auth:"https://auth.split.io/api",streaming:"https://streaming.split.io"},storage:{type:x},debug:void 0,impressionListener:void 0,version:"".concat("javascript","-").concat("10.15.3"),integrations:void 0,streamingEnabled:!0,sync:{splitFilters:void 0,impressionsMode:V}};function me(t){return Math.round(1e3*t)}function ye(t){var e,n=Object(a.k)({},ve,ee,t);n.scheduler.featuresRefreshRate=me(n.scheduler.featuresRefreshRate),n.scheduler.segmentsRefreshRate=me(n.scheduler.segmentsRefreshRate),n.scheduler.metricsRefreshRate=me(n.scheduler.metricsRefreshRate),n.scheduler.impressionsRefreshRate=me(n.scheduler.impressionsRefreshRate),n.scheduler.offlineRefreshRate=me(n.scheduler.offlineRefreshRate),n.scheduler.eventsPushRate=me(n.scheduler.eventsPushRate),n.startup.requestTimeoutBeforeReady=me(n.startup.requestTimeoutBeforeReady),n.startup.readyTimeout=me(n.startup.readyTimeout),n.startup.eventsFirstPushWindow=me(n.startup.eventsFirstPushWindow),n.mode=ce(n.core.authorizationKey,n.mode),n.storage=ie(n),"boolean"===typeof(e=n.debug)?e?s.a.enable():s.a.disable():"string"===typeof e&&s.a.setLogLevel(e),n.runtime=(n.core.IPAddressesEnabled,n.mode,{ip:!1,hostname:!1}),n.integrations=se(n),!1!==n.streamingEnabled&&(n.streamingEnabled=!0,n.scheduler.authRetryBackoffBase=me(n.scheduler.authRetryBackoffBase),n.scheduler.streamingReconnectBackoffBase=me(n.scheduler.streamingReconnectBackoffBase));var r=le(n.sync.splitFilters,n.mode);return n.sync.splitFilters=r.validFilters,n.sync.__splitFiltersValidation=r,n.sync.impressionsMode=he(n.sync.impressionsMode),n}var be={url:function(t){return pe.test(t)?"".concat(this.urls.events).concat(t):ge.test(t)?"".concat(this.urls.auth).concat(t):de.test(t)?"".concat(this.urls.streaming).concat(t):"".concat(this.urls.sdk).concat(t)},overrideKeyAndTT:function(t,e){return i()(Object.create(be),this,{core:i()({},this.core,{key:t,trafficType:e})})}},Se=function(t){return i()(Object.create(be),ye(t))},Te={COLLECTORS:"metrics_collectors",DESTROYED:"is_destroyed",EVENTS:"events_publisher",HAS_TIMEDOUT:"has_timedout",INTEGRATIONS_MANAGER:"integrations_manager",MY_SEGMENTS_CHANGE_WORKER:"my_segments_change_worker",PRODUCER:"producer",READINESS:"readiness_gate",READY:"is_ready",READY_FROM_CACHE:"is_ready_from_cache",SETTINGS:"settings",STATUS_MANAGER:"status_manager",STORAGE:"storage",IMPRESSIONS_COUNTER:"impressions_counter"},Ee=function(){function t(){Object(ct.a)(this,t),this._map={},this.constants=Te}return Object(ut.a)(t,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"===typeof t&&("string"!==typeof t||t.length)){var n=this._map[t];if(void 0!==n)return n;if(!e){var r,i=new Promise((function(t){return r=t}));return i.manualResolve=r,this._map[t]=i,i}}}},{key:"getAll",value:function(){return i()({},this._map)}},{key:"put",value:function(t,e){var n=this;if("string"!==typeof t||"string"===typeof t&&!t.length||void 0===e)return!1;var r=this._map[t];return(void 0===r||"function"===typeof r.manualResolve)&&(o(r)&&r.manualResolve&&r.manualResolve(e),o(e)&&e.then((function(e){return n._map[t]=e,e})).catch((function(e){return n._map[t]=void 0,e})),this._map[t]=e,!0)}}]),t}(),Oe=function(t){return Object(a.i)(t)?{matchingKey:t.matchingKey,bucketingKey:t.bucketingKey}:{matchingKey:t,bucketingKey:t}};function _e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ke=n(4042),Ne=n(3014);var Ae="object"===("undefined"===typeof performance?"undefined":Object(Ne.a)(performance))&&"function"===typeof performance.now?performance.now.bind(performance):Date.now;var Re,we=function(){var t=Ae();return function(){return Math.round(Ae()-t)}},Ie=new ke.b("[TIME TRACKER]",{showLevel:!1}),Ce={},je={SDK_READY:"Getting ready - Split SDK",SDK_GET_TREATMENT:"SDK - Get Treatment",SDK_GET_TREATMENTS:"SDK - Get Treatments",SDK_GET_TREATMENT_WITH_CONFIG:"SDK - Get Treatment with config",SDK_GET_TREATMENTS_WITH_CONFIG:"SDK - Get Treatments with config",SPLITS_READY:"Getting ready - Splits",SEGMENTS_READY:"Getting ready - Segments",METRICS_PUSH:"Pushing - Metrics",IMPRESSIONS_PUSH:"Pushing - Impressions",EVENTS_PUSH:"Pushing - Events",MY_SEGMENTS_FETCH:"Fetching - My Segments",SEGMENTS_FETCH:"Fetching - Segments",SPLITS_FETCH:"Fetching - Splits"},De=(_e(Re={},je.SDK_READY,{collector:"client",method:"ready"}),_e(Re,je.SDK_GET_TREATMENT,{collector:"client",method:"getTreatment"}),_e(Re,je.SDK_GET_TREATMENTS,{collector:"client",method:"getTreatments"}),_e(Re,je.SDK_GET_TREATMENT_WITH_CONFIG,{collector:"client",method:"getTreatmentWithConfig"}),_e(Re,je.SDK_GET_TREATMENTS_WITH_CONFIG,{collector:"client",method:"getTreatmentsWithConfig"}),_e(Re,je.MY_SEGMENTS_FETCH,{collector:"mySegments",method:"latency"}),_e(Re,je.SEGMENTS_FETCH,{collector:"segmentChanges",method:"latency"}),_e(Re,je.SPLITS_FETCH,{collector:"splitChanges",method:"latency"}),Re),Le=function(t,e){return"string"===typeof e?t+e:t},Me=function(t,e){var n=De[t];return!(!n||!e)&&e[n.collector]},Pe=function(t,e){var n=De[t];return!(!n||!e)&&e[n.method]},Fe={__attachToPromise:function(t,e,n,r){var i=this;return t.then((function(t){return i.stop(e,r),n&&n.count&&n.count(t.status),t})).catch((function(t){throw i.stop(e,r),n&&n.countException&&n.countException(),t}))},start:function(t,e,n){var r,i=Object(a.t)(),s=Me(t,e);o(n)?r=this.__attachToPromise(n,t,s,i):(r=this.stop.bind(this,t,i),De[t]&&!s&&(r.setCollectorForTask=this.setCollectorForTask.bind(this,t,i)));var c=Le(t,i),u=Pe(t,s);return Ce[c]={cb:u,timer:we()},r},setCollectorForTask:function(t,e,n){var r=Me(t,n);if(r){var i=Le(t,e);Ce[i].cb=Pe(t,r)}},stop:function(t,e){var n=Le(t,e),r=Ce[n];if(r){var i=r.timer();return Ie.debug("[".concat(t,"] took ").concat(i,"ms to finish.")),r.cb&&r.cb(i),delete Ce[n],i}},TaskNames:je},Ke={ALL:1,SEGMENT:2,WHITELIST:3,EQUAL_TO:4,GREATER_THAN_OR_EQUAL_TO:5,LESS_THAN_OR_EQUAL_TO:6,BETWEEN:7,UNDEFINED:8,EQUAL_TO_SET:9,CONTAINS_ANY_OF_SET:10,CONTAINS_ALL_OF_SET:11,PART_OF_SET:12,ENDS_WITH:13,STARTS_WITH:14,CONTAINS_STRING:15,IN_SPLIT_TREATMENT:16,EQUAL_TO_BOOLEAN:17,MATCHES_STRING:18},xe={BOOLEAN:"BOOLEAN",STRING:"STRING",NUMBER:"NUMBER",SET:"SET",DATETIME:"DATETIME",NOT_SPECIFIED:"NOT_SPECIFIED"};var Ue=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.segmentName},Ge=function(){function t(){var e=this;Object(ct.a)(this,t),this.__setData__=[];var n=arguments[0];Array.isArray(n)&&n.forEach((function(t){e.add(t)}))}return Object(ut.a)(t,[{key:"clear",value:function(){this.__setData__.length&&(this.__setData__.length=0)}},{key:"add",value:function(t){return this.has(t)||this.__setData__.push(t),this}},{key:"delete",value:function(t){var e=this.__setData__.indexOf(t);return-1!==e&&(this.__setData__.splice(e,1),!0)}},{key:"has",value:function(t){return-1!==this.__setData__.indexOf(t)}},{key:"forEach",value:function(t){var e=arguments[1];if("function"!==typeof t)throw new TypeError(t+" is not a function");for(var n=0;n<this.__setData__.length;n++){var r=this.__setData__[n];t.call(e,r,r,this)}}},{key:"size",get:function(){return this.__setData__.length}}]),t}();function He(t){return t instanceof Ge?t.__setData__.slice():Array.from(t)}var We=Array.from&&"function"===typeof Set&&Set.prototype&&Set.prototype.values?Set:Ge;var Be=function(t){return new We(t.whitelist)};var Ye=function(t){return t.whitelist};var qe=function(t){return t.value};function ze(t){return new Date(t).setUTCHours(0,0,0,0)}function Qe(t){return new Date(t).setUTCSeconds(0,0)}var Ve=function(t){var e=t.map((function(t){var e=t.matcherType,n=t.negate,r=t.keySelector,i=t.userDefinedSegmentMatcherData,o=t.whitelistMatcherData,a=t.unaryNumericMatcherData,s=t.betweenMatcherData,c=t.dependencyMatcherData,u=t.booleanMatcherData,l=t.stringMatcherData,f=r&&r.attribute,h=function(t){switch(t){case"ALL_KEYS":return Ke.ALL;case"IN_SEGMENT":return Ke.SEGMENT;case"WHITELIST":return Ke.WHITELIST;case"EQUAL_TO":return Ke.EQUAL_TO;case"GREATER_THAN_OR_EQUAL_TO":return Ke.GREATER_THAN_OR_EQUAL_TO;case"LESS_THAN_OR_EQUAL_TO":return Ke.LESS_THAN_OR_EQUAL_TO;case"BETWEEN":return Ke.BETWEEN;case"EQUAL_TO_SET":return Ke.EQUAL_TO_SET;case"CONTAINS_ANY_OF_SET":return Ke.CONTAINS_ANY_OF_SET;case"CONTAINS_ALL_OF_SET":return Ke.CONTAINS_ALL_OF_SET;case"PART_OF_SET":return Ke.PART_OF_SET;case"ENDS_WITH":return Ke.ENDS_WITH;case"STARTS_WITH":return Ke.STARTS_WITH;case"CONTAINS_STRING":return Ke.CONTAINS_STRING;case"IN_SPLIT_TREATMENT":return Ke.IN_SPLIT_TREATMENT;case"EQUAL_TO_BOOLEAN":return Ke.EQUAL_TO_BOOLEAN;case"MATCHES_STRING":return Ke.MATCHES_STRING;default:return Ke.UNDEFINED}}(e),p=xe.STRING,g=void 0;return h===Ke.SEGMENT?g=Ue(i):h===Ke.WHITELIST?g=Be(o):h===Ke.EQUAL_TO?(g=qe(a),p=xe.NUMBER,"DATETIME"===a.dataType&&(g=ze(g),p=xe.DATETIME)):h===Ke.GREATER_THAN_OR_EQUAL_TO||h===Ke.LESS_THAN_OR_EQUAL_TO?(g=qe(a),p=xe.NUMBER,"DATETIME"===a.dataType&&(g=Qe(g),p=xe.DATETIME)):h===Ke.BETWEEN?(g=s,p=xe.NUMBER,"DATETIME"===s.dataType&&(g.start=Qe(g.start),g.end=Qe(g.end),p=xe.DATETIME)):h===Ke.EQUAL_TO_SET||h===Ke.CONTAINS_ANY_OF_SET||h===Ke.CONTAINS_ALL_OF_SET||h===Ke.PART_OF_SET?(g=Ye(o),p=xe.SET):h===Ke.STARTS_WITH||h===Ke.ENDS_WITH||h===Ke.CONTAINS_STRING?g=Ye(o):h===Ke.IN_SPLIT_TREATMENT?(g=c,p=xe.NOT_SPECIFIED):h===Ke.EQUAL_TO_BOOLEAN?(p=xe.BOOLEAN,g=u):h===Ke.MATCHES_STRING&&(g=l),{attribute:f,negate:n,type:h,value:g,dataType:p}}));return-1===Object(a.c)(e,(function(t){return t.type===Ke.UNDEFINED}))?e:[]};function Je(t,e){if(!(this instanceof Je))return new Je(t,e);if(100!==t[t.length-1])throw new RangeError("Provided invalid dataset as input");this._ranges=t,this._treatments=e}Je.parse=function(t){var e=t.reduce((function(t,e){var n=e.size,r=e.treatment;return t.ranges.push(t.inc+=n),t.treatments.push(r),t}),{inc:0,ranges:[],treatments:[]});return new Je(e.ranges,e.treatments)},Je.prototype.getTreatmentFor=function(t){if(t<0||t>100)throw new RangeError("Please provide a value between 0 and 100");var e=Object(a.c)(this._ranges,(function(e){return t<=e}));return this._treatments[e]};var $e=Je,Ze=Object(s.b)("splitio-engine:matcher");function Xe(t){return Ze.debug("[allMatcher] is always true"),null!=t}var tn=function(){return Xe},en=Object(s.b)("splitio-engine:matcher");var nn=function(t,e){return function(n){var r=e.segments.isInSegment(t,n);return o(r)?r.then((function(e){return en.debug("[asyncSegmentMatcher] evaluated ".concat(t," / ").concat(n," => ").concat(r)),e})):en.debug("[segmentMatcher] evaluated ".concat(t," / ").concat(n," => ").concat(r)),r}},rn=Object(s.b)("splitio-engine:matcher");var on=function(t){return function(e){var n=t.has(e);return rn.debug("[whitelistMatcher] evaluated ".concat(e," in [").concat(He(t).join(","),"] => ").concat(n)),n}},an=Object(s.b)("splitio-engine:matcher");var sn=function(t){return function(e){var n=e===t;return an.debug("[equalToMatcher] is ".concat(e," equal to ").concat(t,"? ").concat(n)),n}},cn=Object(s.b)("splitio-engine:matcher");var un=function(t){return function(e){var n=e>=t;return cn.debug("[greaterThanEqualMatcher] is ".concat(e," greater than ").concat(t,"? ").concat(n)),n}},ln=Object(s.b)("splitio-engine:matcher");var fn=function(t){return function(e){var n=e<=t;return ln.debug("[lessThanEqualMatcher] is ".concat(e," less than ").concat(t,"? ").concat(n)),n}},hn=Object(s.b)("splitio-engine:matcher");var pn=function(t){return function(e){var n=e>=t.start&&e<=t.end;return hn.debug("[betweenMatcher] is ".concat(e," between ").concat(t.start," and ").concat(t.end,"? ").concat(n)),n}},gn=Object(s.b)("splitio-engine:matcher");var dn=function(t){return function(e){for(var n=e.length===t.length,r=function(r){Object(a.c)(t,(function(t){return t===e[r]}))<0&&(n=!1)},i=0;i<e.length&&n;i++)r(i);return gn.debug("[equalToSetMatcher] is ".concat(e," equal to set ").concat(t,"? ").concat(n)),n}},vn=Object(s.b)("splitio-engine:matcher");var mn=function(t){return function(e){var n=!0;if(e.length<t.length)n=!1;else for(var r=function(r){Object(a.c)(e,(function(e){return e===t[r]}))<0&&(n=!1)},i=0;i<t.length&&n;i++)r(i);return vn.debug("[containsAllMatcher] ".concat(e," contains all elements of ").concat(t,"? ").concat(n)),n}},yn=Object(s.b)("splitio-engine:matcher");var bn=function(t){return function(e){for(var n=!1,r=function(r){Object(a.c)(e,(function(e){return e===t[r]}))>=0&&(n=!0)},i=0;i<t.length&&!n;i++)r(i);return yn.debug("[containsAnyMatcher] ".concat(e," contains at least an element of ").concat(t,"? ").concat(n)),n}},Sn=Object(s.b)("splitio-engine:matcher");var Tn=function(t){return function(e){for(var n=e.length<=t.length,r=function(r){Object(a.c)(t,(function(t){return t===e[r]}))<0&&(n=!1)},i=0;i<e.length&&n;i++)r(i);return Sn.debug("[partOfMatcher] ".concat(e," is part of ").concat(t,"? ").concat(n)),n}},En=Object(s.b)("splitio-engine:matcher");var On=function(t){return function(e){var n=t.some((function(t){return Object(a.o)(e,t)}));return En.debug("[startsWithMatcher] ".concat(e," starts with ").concat(t,"? ").concat(n)),n}},_n=Object(s.b)("splitio-engine:matcher");var kn=function(t){return function(e){var n=t.some((function(t){return Object(a.a)(e,t)}));return _n.debug("[endsWithMatcher] ".concat(e," ends with ").concat(t,"? ").concat(n)),n}},Nn=Object(s.b)("splitio-engine:matcher");var An=function(t){return function(e){var n=t.some((function(t){return Object(a.j)(e)&&e.indexOf(t)>-1}));return Nn.debug("[containsStringMatcher] ".concat(e," contains ").concat(t,"? ").concat(n)),n}},Rn=Object(s.b)("splitio-engine:matcher");function wn(t,e,n){var r=!1;return Array.isArray(e)&&(r=-1!==e.indexOf(t.treatment)),Rn.debug('[dependencyMatcher] Parent split "'.concat(n,'" evaluated to "').concat(t.treatment,'" with label "').concat(t.label,'". ').concat(n," evaluated treatment is part of [").concat(e,"] ? ").concat(r,".")),r}var In=function(t,e){var n=t.split,r=t.treatments;return function(t,i){var a=t.key,s=t.attributes;Rn.debug('[dependencyMatcher] will evaluate parent split: "'.concat(n,'" with key: ').concat(JSON.stringify(a)," ").concat(s?"\n attributes: ".concat(JSON.stringify(s)):""));var c=i(a,n,s,e);return o(c)?c.then((function(t){return wn(t,r,n)})):wn(c,r,n)}},Cn=Object(s.b)("splitio-engine:matcher");var jn=function(t){return function(e){var n=t===e;return Cn.debug("[booleanMatcher] ".concat(t," === ").concat(e)),n}},Dn=Object(s.b)("splitio-engine:matcher");var Ln=function(t){return function(e){var n;try{n=new RegExp(t)}catch(e){return Dn.debug("[stringMatcher] ".concat(t," is an invalid regex")),!1}var r=n.test(e);return Dn.debug("[stringMatcher] does ".concat(e," matches with ").concat(t,"? ").concat(r?"yes":"no")),r}};var Mn=function(t,e){var n,r=t.type,i=t.value;return r===Ke.ALL?n=tn(i):r===Ke.SEGMENT?n=nn(i,e):r===Ke.WHITELIST?n=on(i):r===Ke.EQUAL_TO?n=sn(i):r===Ke.GREATER_THAN_OR_EQUAL_TO?n=un(i):r===Ke.LESS_THAN_OR_EQUAL_TO?n=fn(i):r===Ke.BETWEEN?n=pn(i):r===Ke.EQUAL_TO_SET?n=dn(i):r===Ke.CONTAINS_ANY_OF_SET?n=bn(i):r===Ke.CONTAINS_ALL_OF_SET?n=mn(i):r===Ke.PART_OF_SET?n=Tn(i):r===Ke.STARTS_WITH?n=On(i):r===Ke.ENDS_WITH?n=kn(i):r===Ke.CONTAINS_STRING?n=An(i):r===Ke.IN_SPLIT_TREATMENT?n=In(i,e):r===Ke.EQUAL_TO_BOOLEAN?n=jn(i):r===Ke.MATCHES_STRING&&(n=Ln(i)),n},Pn=Object(s.b)("splitio-engine:sanitize"),Fn=Ke,Kn=xe;function xn(t,e){return{key:t,attributes:e}}var Un=function(t,e,n,r){var i,o=function(t,e){switch(t){case Fn.EQUAL_TO:return"DATETIME"===e?ze:void 0;case Fn.GREATER_THAN_OR_EQUAL_TO:case Fn.LESS_THAN_OR_EQUAL_TO:case Fn.BETWEEN:return"DATETIME"===e?Qe:void 0;case Fn.IN_SPLIT_TREATMENT:return xn;default:return}}(t,n);switch(n){case Kn.NUMBER:case Kn.DATETIME:i=function(t){var e=Object(a.p)(t);return isNaN(e)?void 0:e}(e);break;case Kn.STRING:i=function(t){var e=t;return Object(a.i)(t)&&(e=t.matchingKey?t.matchingKey:void 0),Object(a.q)(e)||void 0}(e);break;case Kn.SET:i=function(t){var e=Array.isArray(t)?Object(a.s)(t.map((function(t){return t+""}))):[];return e.length?e:void 0}(e);break;case Kn.BOOLEAN:i=function(t){if(!0===t||!1===t)return t;if("string"===typeof t){var e=t.toLocaleLowerCase();if("true"===e)return!0;if("false"===e)return!1}}(e);break;case Kn.NOT_SPECIFIED:i=e;break;default:i=void 0}return o&&(i=o(i,r)),Pn.debug("Attempted to sanitize [".concat(e,"] which should be of type [").concat(n,"]. \n Sanitized and processed value => [").concat(i instanceof Object?JSON.stringify(i):i,"]")),i},Gn=Object(s.b)("splitio-engine:value");var Hn=function(t,e,n){var r=e.attribute,i=function(t,e,n){var r=void 0;return e?n?(r=n[e],Gn.debug("Extracted attribute [".concat(e,"], [").concat(r,"] will be used for matching."))):Gn.warn("Defined attribute [".concat(e,"], no attributes received.")):r=t,r}(t,r,n),o=Un(e.type,i,e.dataType,n);return void 0!==o?o:void Gn.warn("Value ".concat(i," ").concat(r?"for attribute ".concat(r," "):0,"doesn't match with expected type."))};function Wn(t){return e=function(t){return(t=Number(t))<0?Math.ceil(t):Math.floor(t)}(t),n=Math.pow(2,32),e-Math.floor(e/n)*n;var e,n}function Bn(t){var e=Wn(t);return e>=Math.pow(2,31)?e-Math.pow(2,32):e}function Yn(t,e){for(var n=0,r=0;r<t.length;r++)n=Bn(Bn(31*n)+t.charCodeAt(r));return Bn(n^e)}var qn=function(t,e){return Math.abs(Yn(t,e)%100)+1},zn=n(4739),Qn=n.n(zn),Vn=Qn.a.stringSource,Jn=Qn.a.stringDestination,$n=Qn.a.encodeUTF16toUTF8;function Zn(t,e){return(65535&t)*e+(((t>>>16)*e&65535)<<16)}function Xn(t,e){return t<<e|t>>>32-e}function tr(t,e){e=e||0;for(var n,r=(t=t||"").length%4,i=t.length-r,o=e,a=0,s=3432918353,c=461845907,u=0;u<i;u+=4)a=Zn(a=255&t.charCodeAt(u)|(255&t.charCodeAt(u+1))<<8|(255&t.charCodeAt(u+2))<<16|(255&t.charCodeAt(u+3))<<24,s),a=Zn(a=Xn(a,15),c),o=Zn(o=Xn(o^=a,13),5)+3864292196;switch(a=0,r){case 3:a^=(255&t.charCodeAt(u+2))<<16;case 2:a^=(255&t.charCodeAt(u+1))<<8;case 1:a=Zn(a^=255&t.charCodeAt(u),s),o^=a=Zn(a=Xn(a,15),c)}return o^=t.length,n=o,n=Zn(n^=n>>>16,2246822507),(o=(n=Zn(n^=n>>>13,3266489909))^n>>>16)>>>0}function er(t,e){return tr(function(t){var e;return $n(Vn(t),e=Jn()),e()}(t),e>>>0)}var nr={hash:er,bucket:function(t,e){return Math.abs(er(t,e)%100)+1}},rr=Object(s.b)("splitio-engine");function ir(t){return 2===t?nr.bucket:qn}var or={getTreatment:function(t,e,n,r){var i=ir(r)(t,e),o=n.getTreatmentFor(i);return rr.debug("[engine] using algo ".concat(2!==r?"legacy":"murmur"," bucket ").concat(i," for key ").concat(t," using seed ").concat(e," - treatment ").concat(o)),o},shouldApplyRollout:function(t,e,n,r){if(t<100&&ir(r)(e,n)>t)return!1;return!0}};function ar(t,e,n,r,i,o){if(t)return{treatment:or.getTreatment(e,n,r,o),label:i}}var sr=function(t,e,n,r){return function(i,a,s,c,u,l,f){if("ROLLOUT"===r&&!or.shouldApplyRollout(s,i.bucketingKey,c,f))return{treatment:void 0,label:"not in split"};var h=t(i,l,u);return o(h)?h.then((function(t){return ar(t,i.bucketingKey,a,e,n,f)})):ar(h,i.bucketingKey,a,e,n,f)}},cr=Object(s.b)("splitio-engine:combiner");function ur(){return cr.error("Invalid Split provided, no valid conditions found"),{treatment:G,label:R}}function lr(t){for(var e=t.length,n=0;n<e;n++){var r=t[n];if(void 0!==r)return cr.debug("Treatment found: ".concat(r.treatment)),r}cr.debug("All predicates evaluated, no treatment found.")}var fr=function(t){return!Array.isArray(t)||Array.isArray(t)&&0===t.length?ur:function(e,n,r,i,s,c,u){var l=t.map((function(t){return t(e,n,r,i,u,s,c)}));return-1!==Object(a.c)(l,o)?Promise.all(l).then((function(t){return lr(t)})):lr(l)}},hr=Object(s.b)("splitio-engine:combiner");function pr(t){for(var e,n=0,r=t.length;n<r&&t[n];n++);return e=n===r,hr.debug("[andCombiner] evaluates to ".concat(e)),e}var gr=function(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=t.map((function(t){return t.apply(void 0,n)}));return-1!==Object(a.c)(i,o)?Promise.all(i).then(pr):pr(i)}};var dr=function(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r],a=i.matcherGroup.matchers,s=i.partitions,c=i.label,u=i.conditionType,l=(a=Ve(a)).map((function(t){var n=Mn(t,e);return function(e,r,i){var a=Hn(e,t,r),s=void 0!==a&&n(a,i);return o(s)?s.then((function(e){return Boolean(e^t.negate)})):Boolean(s^t.negate)}}));if(0===l.length){n=[];break}n.push(sr(gr(l),$e.parse(s),c,u))}return fr(n)};function vr(t,e){return{treatment:Object(a.e)(t,"treatment",e),label:Object(a.e)(t,"label","default rule")}}function mr(t,e){if(!(this instanceof mr))return new mr(t,e);var n;this.baseInfo=t,this.evaluator=e,"string"!==typeof(n=this).baseInfo.defaultTreatment&&(n.baseInfo.defaultTreatment=G)}mr.parse=function(t,e){var n=t.conditions,r=dr(n,e);return new mr(i()({},t),r)},mr.prototype.getKey=function(){return this.baseInfo.name},mr.prototype.getTreatment=function(t,e,n){var r,i,a,s=this.baseInfo,c=s.killed,u=s.seed,l=s.defaultTreatment,f=s.trafficAllocation,h=s.trafficAllocationSeed,p=s.algo;try{r=Oe(t)}catch(t){return{treatment:G,label:R}}if(this.isGarbage())i=G,a="archived";else{if(!c){var g=this.evaluator(r,u,f,h,e,p,n);return o(g)?g.then((function(t){return vr(t,l)})):vr(g,l)}i=l,a="killed"}return{treatment:i,label:a}},mr.prototype.isGarbage=function(){return"ARCHIVED"===this.baseInfo.status},mr.prototype.getChangeNumber=function(){return this.baseInfo.changeNumber};var yr=mr,br={treatment:G,label:R,config:null};function Sr(t,e,n,r){var i;try{i=r.splits.getSplit(e)}catch(t){return Promise.resolve(br)}return o(i)?i.then((function(e){return Er(e,t,n,r)})):Er(i,t,n,r)}function Tr(t,e,n,r){var i,a={};try{i=r.splits.fetchMany(e)}catch(t){return e.forEach((function(t){a[t]=br})),Promise.resolve(a)}return o(i)?i.then((function(i){return Or(e,i,t,n,r)})):Or(e,i,t,n,r)}function Er(t,e,n,r){var i={treatment:G,label:A,config:null};if(t){var s=JSON.parse(t),c=yr.parse(s,r);if(i=c.getTreatment(e,n,Sr),o(i))return i.then((function(t){return t.changeNumber=c.getChangeNumber(),t.config=Object(a.e)(s,"configurations.".concat(t.treatment),null),t}));i.changeNumber=c.getChangeNumber(),i.config=Object(a.e)(s,"configurations.".concat(i.treatment),null)}return i}function Or(t,e,n,r,i){var a={},s=[];return t.forEach((function(t){var c=Er(e[t],n,r,i);o(c)?s.push(c.then((function(e){a[t]=e}))):a[t]=c})),s.length>0?Promise.all(s).then((function(){return a})):a}var _r=function t(e,n,r,i){Object(ct.a)(this,t),this.list=i,this.value=e,n?(n.next=this,this.prev=n):this.prev=null,r?(r.prev=this,this.next=r):this.next=null},kr=function(){function t(){Object(ct.a)(this,t),this.tail=null,this.head=null,this.length=0}return Object(ut.a)(t,[{key:"removeNode",value:function(t){if(t&&t instanceof _r){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,e}}},{key:"unshiftNode",value:function(t){if(t&&t instanceof _r&&t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}}},{key:"unshift",value:function(){for(var t=0,e=arguments.length;t<e;t++)this.head=new _r(arguments[t],null,this.head,this),this.tail||(this.tail=this.head),this.length++;return this.length}}]),t}(),Nr="undefined"!==typeof Map?Map:function(){function t(){Object(ct.a)(this,t)}return Object(ut.a)(t,[{key:"set",value:function(t,e){this[t]=e}},{key:"get",value:function(t){return this[t]}},{key:"delete",value:function(t){delete this[t]}},{key:"size",get:function(){return Object.keys(this).length}}]),t}(),Ar=function(){function t(e){Object(ct.a)(this,t),this.maxLen=e||1,this.items=new Nr,this.lru=new kr}return Object(ut.a)(t,[{key:"get",value:function(t){var e=this.items.get(t);if(e&&e instanceof _r)return this.lru.unshiftNode(e),e.value.value}},{key:"set",value:function(t,e){var n=this.items.get(t);if(n){if(!(n instanceof _r))return!1;this.lru.unshiftNode(n),this.lru.head.value.value=e}else{if(this.lru.length===this.maxLen){var r=this.lru.tail;if(!r)return!1;this.items.delete(r.value.key),this.lru.removeNode(this.lru.tail)}this.lru.unshift({key:t,value:e}),this.items.set(t,this.lru.head)}return!0}}]),t}(),Rr=function(){function t(e,n){Object(ct.a)(this,t),this.cache=new Ar(e),this.hasher=n}return Object(ut.a)(t,[{key:"testAndSet",value:function(t){if(!t)return null;var e=this.hasher(t),n=this.cache.get(e);return this.cache.set(e,t.time),n}}]),t}();function wr(t){return t||"UNKNOWN"}function Ir(t){return t?nr.hash(function(t){return"".concat(wr(t.keyName),"\n    :").concat(wr(t.feature),"\n    :").concat(wr(t.treatment),"\n    :").concat(wr(t.label),"\n    :").concat(t.changeNumber||0)}(t)).toString():null}var Cr=function(){return new Rr(500,Ir)};function jr(t){return t-t%36e5}var Dr=Object(s.b)("splitio-client:impressions-tracker");function Lr(t){return[F,P].indexOf(t.mode)>-1}var Mr=function(t){var e=t.get(t.constants.STORAGE).impressions,n=t.get(t.constants.SETTINGS),r=n.impressionListener,a=t.get(t.constants.INTEGRATIONS_MANAGER,!0),s=n.runtime,c=s.ip,u=s.hostname,l=n.version,f=[],h=Lr(n),p=function(t){return!!Lr(t)&&t.sync.impressionsMode===V}(n),g=Cr(),d=t.get(t.constants.IMPRESSIONS_COUNTER);return{queue:function(t,e){f.push({impression:t,attributes:e})},track:function(){var t=f.length,n=f.splice(0,t),s=[];n.forEach((function(t){var e=t.impression;h&&(e.pt=g.testAndSet(e));var n=Date.now();p&&d&&d.inc(e.feature,n,1),(!p||!e.pt||e.pt<jr(n))&&s.push(e)}));var v=e.track(s);if(o(v)&&v.then((function(){Dr.debug("Successfully stored ".concat(t," impression").concat(1===t?"":"s","."))})).catch((function(e){Dr.error("Could not store impressions bulk with ".concat(t," impression").concat(1===t?"":"s",". Error: ").concat(e))})),r||a)for(var m=function(t){var e={impression:i()({},n[t].impression),attributes:n[t].attributes,ip:c,hostname:u,sdkLanguageVersion:l};setTimeout((function(){a&&a.handleImpression(e);try{r&&r.logImpression(e)}catch(t){Dr.error("Impression listener logImpression method threw: ".concat(t,"."))}}),0)},y=0;y<t;y++)m(y)}}},Pr=Object(s.b)("splitio-client:event-tracker");var Fr=function(t){var e=t.get(t.constants.STORAGE).events,n=t.get(t.constants.INTEGRATIONS_MANAGER,!0);function r(t,e){var r=t.eventTypeId,o=t.trafficTypeName,a=t.key,s=t.value,c=t.timestamp,u=t.properties,l='event of type "'.concat(r,'" for traffic type "').concat(o,'". Key: ').concat(a,". Value: ").concat(s,". Timestamp: ").concat(c,". ").concat(u?"With properties.":"With no properties.");return e?(Pr.info("Successfully qeued ".concat(l)),n&&setTimeout((function(){var e=i()({},t);t.properties&&(e.properties=i()({},t.properties)),n.handleEvent(e)}),0)):Pr.warn("Failed to queue ".concat(l)),e}return{track:function(t,n){var i=e.track(t,n);return o(i)?i.then(r.bind(null,t)):r(t,i)}}},Kr=Object(s.b)("splitio-client");var xr=function(t){var e=t.get(t.constants.STORAGE),n=t.get(t.constants.COLLECTORS),r=Mr(t),i=Fr(t);function a(t,i,a){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=Fe.TaskNames[s?"SDK_GET_TREATMENT_WITH_CONFIG":"SDK_GET_TREATMENT"],l=Fe.start(u,n),f=Sr(t,i,a,e),h=function(e){var n=c(e,i,t,a,s,"getTreatment".concat(s?"withConfig":""));return r.track(),l(),n};return o(f)?f.then((function(t){return h(t)})):h(f)}function s(t,i,a){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=Fe.TaskNames[s?"SDK_GET_TREATMENTS_WITH_CONFIG":"SDK_GET_TREATMENTS"],l=Fe.start(u,n),f=function(e){var n={};return Object.keys(e).forEach((function(r){n[r]=c(e[r],r,t,a,s,"getTreatments".concat(s?"withConfig":""))})),r.track(),l(),n},h=Tr(t,i,a,e);return o(h)?h.then((function(t){return f(t)})):f(h)}function c(e,n,i,o,a,s){var c=t.get(t.constants.READY,!0)||t.get(t.constants.READY_FROM_CACHE,!0),u=xt(i),l=Ut(i);c||(e={treatment:G,label:"not ready"});var f=e,h=f.treatment,p=f.label,g=f.changeNumber,d=f.config,v=void 0===d?null:d;return Kr.info("Split: ".concat(n,". Key: ").concat(u,". Evaluation: ").concat(h,". Label: ").concat(p)),j(t,n,p,s)&&(Kr.info("Queueing corresponding impression."),r.queue({feature:n,keyName:u,treatment:h,time:Date.now(),bucketingKey:l,label:p,changeNumber:g},o)),a?{treatment:h,config:v}:h}return{getTreatment:a,getTreatmentWithConfig:function(t,e,n){return a(t,e,n,!0)},getTreatments:s,getTreatmentsWithConfig:function(t,e,n){return s(t,e,n,!0)},track:function(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1024,c=xt(e),u=Date.now(),l={eventTypeId:r,trafficTypeName:n,value:o,timestamp:u,key:c,properties:a};return tt(n,t,"track"),i.track(l,s)}}};var Ur=function(t,e,n){var r="REDIS"!==t.get(t.constants.SETTINGS).storage.type,o=xr(t),s=o.getTreatment,c=o.getTreatmentWithConfig,u=o.getTreatments,l=o.getTreatmentsWithConfig,h=o.track;function p(n,r,i,o){var s,c,u=Object(a.o)(o,"getTreatments"),l=e?n:N(n,o),h=u?L(r,o):C(r,o),p=(s=i,c=o,Object(a.i)(s)||void 0==s?s:(f.error("".concat(c,": attributes must be a plain object.")),!1)),g=nt(t);return rt(t,o),{valid:g&&l&&h&&!1!==p,key:l,splitOrSplits:h,attributes:p}}return o.getTreatment=function(t,e,n){var i=p(t,e,n,"getTreatment");return i.valid?s(i.key,i.splitOrSplits,i.attributes):r?G:Promise.resolve(G)},o.getTreatmentWithConfig=function(t,e,n){var o=p(t,e,n,"getTreatmentWithConfig");return o.valid?c(o.key,o.splitOrSplits,o.attributes):r?i()({},H):Promise.resolve(i()({},H))},o.getTreatments=function(t,e,n){var i=p(t,e,n,"getTreatments");if(i.valid)return u(i.key,i.splitOrSplits,i.attributes);var o={};return i.splitOrSplits&&i.splitOrSplits.forEach((function(t){return o[t]=G})),r?o:Promise.resolve(o)},o.getTreatmentsWithConfig=function(t,e,n){var o=p(t,e,n,"getTreatmentsWithConfig");if(o.valid)return l(o.key,o.splitOrSplits,o.attributes);var a={};return o.splitOrSplits&&o.splitOrSplits.forEach((function(t){return a[t]=i()({},H)})),r?a:Promise.resolve(a)},o.track=function(i,o,a,s,c){var u=e?i:N(i,"track"),l=n?o:Z(o,"track"),f=g(a,"track"),p=v(s,"track"),d=O(c,"track"),m=d.properties,y=d.size;return nt(t)&&u&&l&&f&&!1!==p&&!1!==m?h(u,l,f,p,m,y):!r&&Promise.resolve(!1)},o};var Gr=function(t){var e,n=t.get(t.constants.SETTINGS),r=Object(a.e)(n,"core.key",void 0),i=Object(a.e)(n,"core.trafficType",void 0);n.mode===M&&void 0===r?n.core.key="localhost_key":n.core.key=N(r,"Client instantiation");var o=[n.core.key];if(void 0!==i){var s=Z(i,"Client instantiation");n.core.trafficType=s,o.push(s)}var c=Ur(t,!0,o.length>1);return c.isBrowserClient=!0,c.getTreatment=c.getTreatment.bind(c,n.core.key),c.getTreatmentWithConfig=c.getTreatmentWithConfig.bind(c,n.core.key),c.getTreatments=c.getTreatments.bind(c,n.core.key),c.getTreatmentsWithConfig=c.getTreatmentsWithConfig.bind(c,n.core.key),c.track=(e=c.track).bind.apply(e,[c].concat(o)),c};var Hr=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o,a=!1;function s(){for(var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,r=arguments.length,i=new Array(r>1?r-1:0),c=1;c<r;c++)i[c-1]=arguments[c];a||(o=setTimeout((function(){t.apply(void 0,i.concat([s]))}),n))}function c(){clearTimeout(o),o=void 0,a=!0}return c.reset=function(){clearTimeout(o),o=void 0,s.apply(void 0,[e].concat(r))},t.apply(void 0,r.concat([s])),c},Wr=function(t,e){return e=e||{},new Promise((function(n,r){var i=new XMLHttpRequest,o=[],a=[],s={},c=function(){return{ok:2==(i.status/100|0),statusText:i.statusText,status:i.status,url:i.responseURL,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(i.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([i.response]))},clone:c,headers:{keys:function(){return o},entries:function(){return a},get:function(t){return s[t.toLowerCase()]},has:function(t){return t.toLowerCase()in s}}}};for(var u in i.open(e.method||"get",t,!0),i.onload=function(){i.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(t,e,n){o.push(e=e.toLowerCase()),a.push([e,n]),s[e]=s[e]?s[e]+","+n:n})),n(c())},i.onerror=r,i.withCredentials="include"==e.credentials,e.headers)i.setRequestHeader(u,e.headers[u]);i.send(e.body||null)}))};function Br(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Yr(t,e,n){return(Yr=Br()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&Object(Ct.a)(i,n.prototype),i}).apply(null,arguments)}function qr(t){var e="function"===typeof Map?new Map:void 0;return(qr=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return Yr(t,arguments,Ft(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Object(Ct.a)(r,t)})(t)}function zr(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ft(t);if(e){var i=Ft(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Pt(this,n)}}var Qr=function(t){jt(n,t);var e=zr(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Split Error";return Object(ct.a)(this,n),(t=e.call(this,r)).message=r,t}return n}(qr(Error)),Vr=function(t){jt(n,t);var e=zr(n);function n(t){return Object(ct.a)(this,n),e.call(this,t||"Split Timeout Error")}return n}(Qr),Jr=function(t){jt(n,t);var e=zr(n);function n(t,r){var i;return Object(ct.a)(this,n),(i=e.call(this,t||"Split Network Error")).statusCode=r,i}return n}(Qr),$r=Object(s.b)("splitio-services:service");function Zr(t){var e=t.url;return("undefined"!==typeof window&&window.fetch||Wr)(e,t).then((function(t){if(!t.ok)throw{response:t};return t})).catch((function(n){var r=n.response,i="";if(r)switch(r.status){case 404:i="Invalid API key or resource not found.";break;default:i=r.statusText}else i=n.message;throw r&&403===r.status||$r[t.logErrorsAsInfo?"info":"error"]("Response status is not OK. Status: ".concat(r?r.status:"NO_STATUS",". URL: ").concat(e,". Message: ").concat(i)),new Jr(i,r&&r.status)}))}var Xr=Zr;var ti=function(t,e,n,r){var o=t.core.authorizationKey,a=t.version,s=t.runtime,c=s.ip,u=s.hostname,l={},f={};return l.Accept="application/json",l["Content-Type"]="application/json",l.Authorization="Bearer ".concat(o),l.SplitSDKVersion=a,c&&(l.SplitSDKMachineIP=c),u&&(l.SplitSDKMachineName=u),r&&i()(l,r),i()({headers:l,url:t.url(e)},f,n)};function ei(t){var e=[],n=t.toJSON();return Object(a.d)(n,(function(t,n){e.push({name:n,latencies:t})})),e}function ni(t){var e=[],n=t.toJSON();return Object(a.d)(n,(function(t,n){e.push({name:n,delta:t})})),e}var ri=Zr;function ii(t,e){return ti(t,"/testImpressions/bulk",i()({method:"POST"},e),{SplitSDKImpressionsMode:t.sync.impressionsMode===V?V:Q})}function oi(t,e){return ti(t,"/testImpressions/count",i()({method:"POST"},e))}function ai(t,e){var n=e.core.labelsEnabled,r=Object(a.g)(t.state(),"feature"),i=[];return Object(a.d)(r,(function(t,e){i.push({f:e,i:t.map((function(t){var e={k:t.keyName,t:t.treatment,m:t.time,c:t.changeNumber};return n&&(e.r=t.label),t.bucketingKey&&(e.b=t.bucketingKey),t.pt&&(e.pt=t.pt),e}))})})),i}function si(t){var e=[];if(0===(t?t.size():0))return e;for(var n=t.popAll(),r=Object.keys(n),i=0;i<r.length;i++){var o=r[i].split("::");if(2===o.length){var a=o[0],s=o[1],c={f:a,m:Number(s),rc:n[r[i]]};e.push(c)}}return e}function ci(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ft(t);if(e){var i=Ft(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Pt(this,n)}}var ui=function(){function t(e){Object(ct.a)(this,t),this.storage=e,this.latency=this.latency.bind(this),this.count=this.count.bind(this),this.countException=this.countException.bind(this)}return Object(ut.a)(t,[{key:"latency",value:function(t){this.storage.metrics.track("".concat(this.metricType,".time"),t)}},{key:"count",value:function(t){this.storage.count.track("".concat(this.metricType,".status.").concat(t))}},{key:"countException",value:function(){this.storage.count.track("".concat(this.metricType,".exception"))}}]),t}(),li=function(t){jt(n,t);var e=ci(n);function n(t){var r;return Object(ct.a)(this,n),(r=e.call(this,t)).metricType="segmentChangeFetcher",r}return n}(ui),fi=function(t){jt(n,t);var e=ci(n);function n(t){var r;return Object(ct.a)(this,n),(r=e.call(this,t)).metricType="splitChangeFetcher",r}return n}(ui),hi=function(t){jt(n,t);var e=ci(n);function n(t){var r;return Object(ct.a)(this,n),(r=e.call(this,t)).metricType="mySegmentsFetcher",r}return n}(ui),pi=function(){function t(e){Object(ct.a)(this,t),this.storage=e,this.ready=this.ready.bind(this),this.getTreatment=this.getTreatment.bind(this),this.getTreatments=this.getTreatments.bind(this),this.getTreatmentWithConfig=this.getTreatmentWithConfig.bind(this),this.getTreatmentsWithConfig=this.getTreatmentsWithConfig.bind(this)}return Object(ut.a)(t,[{key:"ready",value:function(t){this.storage.metrics.track("sdk.ready",t)}},{key:"getTreatment",value:function(t){this.storage.metrics.track("sdk.getTreatment",t)}},{key:"getTreatments",value:function(t){this.storage.metrics.track("sdk.getTreatments",t)}},{key:"getTreatmentWithConfig",value:function(t){this.storage.metrics.track("sdk.getTreatmentWithConfig",t)}},{key:"getTreatmentsWithConfig",value:function(t){this.storage.metrics.track("sdk.getTreatmentsWithConfig",t)}}]),t}(),gi=Object(s.b)("splitio-metrics"),di=function(t){var e=0,n=t.get(t.constants.SETTINGS),r=t.get(t.constants.STORAGE),o=t.get(t.constants.IMPRESSIONS_COUNTER),a=n.sync.impressionsMode===V,s=function(){if(r.metrics.isEmpty()&&r.count.isEmpty())return Promise.resolve();gi.info("Pushing metrics");var t=Fe.start(Fe.TaskNames.METRICS_PUSH),e=r.metrics.isEmpty()?null:Xr(function(t,e){return ti(t,"/metrics/times",i()({method:"POST"},e,{logErrorsAsInfo:!0}))}(n,{body:JSON.stringify(ei(r.metrics))})).then((function(){return r.metrics.clear()})).catch((function(){return r.metrics.clear()})),o=r.count.isEmpty()?null:Xr(function(t,e){return ti(t,"/metrics/counters",i()({method:"POST"},e,{logErrorsAsInfo:!0}))}(n,{body:JSON.stringify(ni(r.count))})).then((function(){return r.count.clear()})).catch((function(){return r.count.clear()}));return Promise.all([e,o]).then((function(e){return t(),e}))},c=function(){if(r.impressions.isEmpty())return Promise.resolve();var t=r.impressions.queue.length;gi.info("Pushing ".concat(t," impressions"));var i=Fe.start(Fe.TaskNames.IMPRESSIONS_PUSH);return ri(ii(n,{body:JSON.stringify(ai(r.impressions,n))})).then((function(){e=0,r.impressions.clear()})).catch((function(n){e?(gi.warn("Droping ".concat(t," impressions after retry. Reason ").concat(n,".")),e=0,r.impressions.clear()):(e++,gi.warn("Failed to push ".concat(t," impressions, keeping data to retry on next iteration. Reason ").concat(n,".")))})).then((function(){return i()}))},u=function(){var t=si(o),r=t.length;return 0===r?Promise.resolve():(gi.info("Pushing count of impressions for ".concat(r," features")),ri(oi(n,{body:JSON.stringify({pf:t})})).then((function(){e=0})).catch((function(t){e?(gi.warn("Droping count of impressions for ".concat(r," features after retry. Reason ").concat(t,".")),e=0):(e++,gi.warn("Failed to push impressions count for ".concat(r," features, keeping data to retry on next iteration. Reason ").concat(t,".")))})))},l=!1,f=!1,h=!1;return{start:function(){l=Hr((function(t){return c().then((function(){return t()}))}),n.scheduler.impressionsRefreshRate),f=Hr((function(t){return s().then((function(){return t()}))}),n.scheduler.metricsRefreshRate),a&&(h=Hr((function(t){return u().then((function(){return t()}))}),18e5))},flush:function(){return a&&u(),c()},stop:function(){l&&l(),f&&f(),h&&h()},collectors:{segmentChanges:new li(r),splitChanges:new fi(r),mySegments:new hi(r),client:new pi(r)}}},vi=Zr;function mi(t,e){return ti(t,"/events/bulk",i()({method:"POST"},e))}var yi=Object(s.b)("splitio-events"),bi=function(t){var e=t.get(t.constants.SETTINGS),n=t.get(t.constants.STORAGE),r=function(){if(n.events.isEmpty())return Promise.resolve();yi.info("Pushing ".concat(n.events.state().length," queued events."));var t=Fe.start(Fe.TaskNames.EVENTS_PUSH),r=JSON.stringify(n.events.toJSON()),i=function(){return t()};return n.events.clear(),vi(mi(e,{body:r})).then(i).catch(i)},i=!1,o=!1,a=function(){return o=Hr((function(t){return r().then((function(){return t()}))}),e.scheduler.eventsPushRate)};return{start:function(){e.startup.eventsFirstPushWindow>0?i=setTimeout(a,e.startup.eventsFirstPushWindow):a()},flush:function(){return r()},stop:function(){i&&clearTimeout(i),o&&o()},flushAndResetTimer:function(){return yi.info("Flushing events and reseting timer."),o&&o.reset(),r()}}},Si=Zr;function Ti(t){return"users="+encodeURIComponent(t)}function Ei(t){var e,n=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent((e=n,atob(e)).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(r)}function Oi(t,e){return Si(function(t,e){var n="/auth";if(e){var r=e.map(Ti).join("&");r&&(n+="?"+r)}return ti(t,n)}(t,e)).then((function(t){return t.json()})).then((function(t){if(t.token){var e=Ei(t.token);if("number"!==typeof e.iat||"number"!==typeof e.exp)throw'token properties "issuedAt" (iat) or "expiration" (exp) are missing or invalid';var n=JSON.parse(e["x-ably-capability"]);return i()({decodedToken:e,channels:n},t)}return t}))}function _i(){return"undefined"!==typeof window&&"function"===typeof window.EventSource?window.EventSource:void 0}var ki=function(){function t(e,n,r){Object(ct.a)(this,t),this.baseMillis=n||t.DEFAULT_BASE_MILLIS,this.maxMillis=r||t.DEFAULT_MAX_MILLIS,this.attempts=0,this.cb=e}return Object(ut.a)(t,[{key:"scheduleCall",value:function(){var t=this,e=Math.min(this.baseMillis*Math.pow(2,this.attempts),this.maxMillis);return this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout((function(){t.cb()}),e),this.attempts++,e}},{key:"reset",value:function(){this.attempts=0,this.timeoutID&&(clearTimeout(this.timeoutID),this.timeoutID=0)}}]),t}();ki.DEFAULT_BASE_MILLIS=1e3,ki.DEFAULT_MAX_MILLIS=18e5;var Ni=ki,Ai=function(){function t(e,n){Object(ct.a)(this,t),this.mySegmentsStorage=e,this.mySegmentsProducer=n,this.maxChangeNumber=0,this.segmentList=void 0,this.currentChangeNumber=-1,this.put=this.put.bind(this),this.__handleMySegmentUpdateCall=this.__handleMySegmentUpdateCall.bind(this),this.backoff=new Ni(this.__handleMySegmentUpdateCall)}return Object(ut.a)(t,[{key:"__handleMySegmentUpdateCall",value:function(){var t=this;if(this.maxChangeNumber>this.currentChangeNumber){this.handleNewEvent=!1;var e=this.maxChangeNumber;this.mySegmentsProducer.synchronizeMySegments(this.segmentList).then((function(n){!1!==n&&(t.currentChangeNumber=Math.max(t.currentChangeNumber,e)),t.handleNewEvent?t.__handleMySegmentUpdateCall():t.backoff.scheduleCall()}))}}},{key:"put",value:function(t,e){t<=this.currentChangeNumber||t<=this.maxChangeNumber||(this.maxChangeNumber=t,this.handleNewEvent=!0,this.backoff.reset(),this.segmentList=e,this.mySegmentsProducer.isSynchronizingMySegments()||this.__handleMySegmentUpdateCall())}}]),t}(),Ri=function(){function t(e,n,r){Object(ct.a)(this,t),this.splitStorage=e,this.splitProducer=n,this.maxChangeNumber=0,this.splitsEventEmitter=r,this.put=this.put.bind(this),this.killSplit=this.killSplit.bind(this),this.__handleSplitUpdateCall=this.__handleSplitUpdateCall.bind(this),this.backoff=new Ni(this.__handleSplitUpdateCall)}return Object(ut.a)(t,[{key:"__handleSplitUpdateCall",value:function(){var t=this;this.maxChangeNumber>this.splitStorage.getChangeNumber()&&(this.handleNewEvent=!1,this.splitProducer.synchronizeSplits().then((function(){t.handleNewEvent?t.__handleSplitUpdateCall():t.backoff.scheduleCall()})))}},{key:"put",value:function(t){t<=this.splitStorage.getChangeNumber()||t<=this.maxChangeNumber||(this.maxChangeNumber=t,this.handleNewEvent=!0,this.backoff.reset(),this.splitProducer.isSynchronizingSplits()||this.__handleSplitUpdateCall())}},{key:"killSplit",value:function(t,e,n){var r=this;this.splitStorage.killLocally(e,n,t).then((function(e){e&&r.splitsEventEmitter.emit(r.splitsEventEmitter.SDK_SPLITS_ARRIVED,!0),r.put(t)}))}}]),t}(),wi=/^control_/,Ii=function(){function t(e,n){Object(ct.a)(this,t),this.EventSource=e,this.streamingUrl=n.url("/sse"),this.reopen=this.reopen.bind(this)}return Object(ut.a)(t,null,[{key:"getInstance",value:function(e){var n=_i();if(n)return new t(n,e)}}]),Object(ut.a)(t,[{key:"setEventHandler",value:function(t){this.handler=t}},{key:"open",value:function(t){this.close(),this.authToken=t;var e=Object.keys(t.channels).map((function(t){var e=wi.test(t)?"[?occupancy=metrics.publishers]":"";return encodeURIComponent(e+t)})).join(","),n="".concat(this.streamingUrl,"?channels=").concat(e,"&accessToken=").concat(t.token,"&v=").concat("1.1","&heartbeats=true");this.connection=new this.EventSource(n),this.handler&&(this.connection.onopen=this.handler.handleOpen,this.connection.onmessage=this.handler.handleMessage,this.connection.onerror=this.handler.handleError)}},{key:"close",value:function(){this.connection&&this.connection.close()}},{key:"reopen",value:function(){this.open(this.authToken)}}]),t}(),Ci="PUSH_CONNECT",ji="PUSH_DISABLED",Di="PUSH_DISCONNECT",Li="SSE_ERROR",Mi="MY_SEGMENTS_UPDATE",Pi="SEGMENT_UPDATE",Fi="SPLIT_KILL",Ki="SPLIT_UPDATE",xi="CONTROL",Ui="OCCUPANCY",Gi="STREAMING_DISABLED",Hi="STREAMING_PAUSED",Wi="STREAMING_RESUMED";var Bi=/control_pri$/;var Yi=Object(s.b)("splitio-sync:sse-handler");function qi(t){var e=function(t){var e=-1,n=!0,r=-1,i=!0;return{handleOpen:function(){t.emit(Ci)},isStreamingUp:function(){return i&&n},handleOccupancyEvent:function(r,o,a){Bi.test(o)&&a>e&&(e=a,i&&(0===r&&n?t.emit(Di):0===r||n||t.emit(Ci)),n=0!==r)},handleControlEvent:function(e,o,a){Bi.test(o)&&a>r&&(r=a,e===Gi?t.emit(ji):n&&(e===Hi&&i?t.emit(Di):e!==Wi||i||t.emit(Ci)),i=e===Wi)}}}(t);return{handleOpen:function(){e.handleOpen()},handleError:function(e){var n=e;try{n=function(t){return Object(a.j)(t.data)&&(t.parsedData=JSON.parse(t.data)),t}(e)}catch(t){Yi.warn("Error parsing SSE error notification: ".concat(t))}t.emit(Li,n)},handleMessage:function(n){var r;try{r=function(t){var e=JSON.parse(t.data);return e.parsedData=JSON.parse(e.data),e.name&&"[meta]occupancy"===e.name&&(e.parsedData.type=Ui),e}(n)}catch(t){return void Yi.warn("Error parsing new SSE message notification: ".concat(t))}var i=r,o=i.parsedData,a=i.data,s=i.channel,c=i.timestamp;if(Yi.debug("New SSE message received, with data: ".concat(a,".")),e.isStreamingUp()||o.type===Ui||o.type===xi)switch(o.type){case Ki:t.emit(Ki,o.changeNumber);break;case Pi:t.emit(Pi,o.changeNumber,o.segmentName);break;case Mi:t.emit(Mi,o,s);break;case Fi:t.emit(Fi,o.changeNumber,o.splitName,o.defaultTreatment);break;case Ui:e.handleOccupancyEvent(o.metrics.publishers,s,c);break;case xi:e.handleControlEvent(o.controlType,s,c)}}}}function zi(t){return e=nr.hash(t,0).toString(),btoa(e);var e}var Qi=Object(s.b)("splitio-sync:push-manager");function Vi(t,e){if(n=Qi,_i()?"function"===typeof atob&&"function"===typeof btoa||(n.warn('"atob" and "btoa" functions for Base64 encoding are not available. Falling back to polling mode.'),0):(n.warn("EventSource API is not available. Falling back to polling mode."),0)){var n,r=new Yt.a,o=t.get(t.constants.READINESS).splits,a=t.get(t.constants.SETTINGS),s=t.get(t.constants.STORAGE),c=Ii.getInstance(a),u=qi(r);c.setEventHandler(u);var l,f={},h=[],p=!1,g=new Ni(S,a.scheduler.authRetryBackoffBase),d=new Ni(c.reopen,a.scheduler.streamingReconnectBackoffBase),v=0;r.on(Di,E),r.on(ji,(function(){T(),r.emit(Di)})),r.on(Li,(function(t){var e;c.close(),e=!t.parsedData||400!==t.parsedData.statusCode&&401!==t.parsedData.statusCode?d.scheduleCall():g.scheduleCall();var n=t.parsedData&&t.parsedData.message;Qi.error("Fail to connect to streaming".concat(n?', with error message: "'.concat(n,'"'):"",". Attempting to reconnect in ").concat(e/1e3," seconds.")),r.emit(Di)}));var m=t.get(t.constants.PRODUCER),y=new Ri(s.splits,m,o);if(h.push(y),r.on(Fi,y.killSplit),r.on(Ki,y.put),e)r.on(Mi,(function(n,r){var i=r.split("_")[2],o=f[i];if(o&&e[o]){var a=e[o].get(t.constants.MY_SEGMENTS_CHANGE_WORKER,!0);a&&a.put(n.changeNumber,n.includesPayload?n.segmentList?n.segmentList:[]:void 0)}}));else{var b=new Ai(s.segments,m);h.push(b),r.on(Pi,b.put)}return i()(Object.create(r),{stop:function(){T(),E()},start:S,startNewClient:function(t,e){var n=zi(t),r=e.get(e.constants.STORAGE),i=e.get(e.constants.PRODUCER);f[n]||(f[n]=t,p=!0);var o=new Ai(r.segments,i);h.push(o),e.put(e.constants.MY_SEGMENTS_CHANGE_WORKER,o),setTimeout((function(){p&&(p=!1,S())}),0)},removeClient:function(t){var e=zi(t);delete f[e]}})}function S(){l=!1,Qi.info("Connecting to push streaming.");var t=e?Object.keys(e):void 0;Oi(a,t).then((function(n){if(!l){if(g.reset(),d.reset(),!n.pushEnabled)return Qi.info("Streaming is not available. Switching to polling mode."),void r.emit(Di);if(!(t&&t.length<Object.keys(e).length)){var i=n.decodedToken;c.open(n),function(t,e){v&&clearTimeout(v);var n=e-t-600;Qi.info("Refreshing streaming token in ".concat(n," seconds.")),v=setTimeout(S,1e3*n)}(i.iat,i.exp)}}})).catch((function(t){if(!l){c.close(),r.emit(Di);var e='Failed to authenticate for streaming. Error: "'.concat(t.message,'".');if(t.statusCode>=400&&t.statusCode<500)Qi.error(e);else{var n=g.scheduleCall();Qi.error("".concat(e,". Attempting to reauthenticate in ").concat(n/1e3," seconds."))}}}))}function T(){l=!0,Qi.info("Disconnecting from push streaming."),c.close(),v&&clearTimeout(v),g.reset(),d.reset()}function E(){h.forEach((function(t){return t.backoff.reset()}))}}var Ji=Object(s.b)("splitio-producer:task"),$i=function(t,e){var n=Object(a.f)(t),r=!1;return{start:function(){r||(Ji.debug("Starting ".concat(n," refreshing each ").concat(e)),r=Hr((function(e){Ji.debug("Running ".concat(n)),t().then((function(){return e()}))}),e))},stop:function(){Ji.debug("Stopping ".concat(n)),r&&r(),r=!1},isRunning:function(){return!!r}}};var Zi=function(t,e){return t<1?e:new Promise((function(n,r){var i=setTimeout((function(){r(new Vr("Operation timed out because it exceeded the configured time limit of ".concat(t,"ms.")))}),t);e.then((function(t){clearTimeout(i),n(t)}),(function(t){clearTimeout(i),r(t)}))}))},Xi=Zr;function to(t,e,n){return ti(t,"/splitChanges?since=".concat(e).concat(n||""))}var eo=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=t.sync.__splitFiltersValidation.queryString,a=Xi(to(t,e,o)),s=n||i;return a=Fe.start(Fe.TaskNames.SPLITS_FETCH,!!s&&r,a),n&&(a=Zi(t.startup.requestTimeoutBeforeReady,a)),a.then((function(t){return t.json().catch((function(t){throw new Qr(t.message)}))}))},no=function(t){var e=new We;return t.forEach((function(t){t.matcherGroup.matchers.forEach((function(t){var n=t.matcherType,r=t.userDefinedSegmentMatcherData;"IN_SEGMENT"===n&&e.add(r.segmentName)}))})),e},ro=Object(s.b)("splitio-producer:split-changes");function io(t){var e=t.reduce((function(t,e){return"ACTIVE"===e.status?(t.added.push([e.name,JSON.stringify(e)]),no(e.conditions).forEach((function(e){t.segments.add(e)}))):t.removed.push(e.name),t}),{added:[],removed:[],segments:new We});return e.segments=He(e.segments),e}var oo=Zr;function ao(t){return ti(t,"/mySegments/".concat(encodeURIComponent(xt(t.core.key))))}var so=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=oo(ao(t));return r=Fe.start(Fe.TaskNames.MY_SEGMENTS_FETCH,!!e&&n,r),e&&(r=Zi(t.startup.requestTimeoutBeforeReady,r)),r.then((function(t){return t.json().catch((function(t){throw new Qr(t.message)}))})).then((function(t){return t.mySegments.map((function(t){return t.name}))}))},co=Object(s.b)("splitio-producer:my-segments");var uo=Object(s.b)("splitio-producer:mySegmentsHandler"),lo=function(t){var e=t.get(t.constants.SETTINGS),n=t.get(t.constants.STORAGE).splits,r=t.get(t.constants.READINESS),i=r.splits,o=r.segments,a=function(t){var e=t.getAll(),n=e[t.constants.SETTINGS],r=e[t.constants.READINESS],i=e[t.constants.STORAGE],o=e[t.constants.COLLECTORS],a=r.segments,s=!0,c=!0;function u(t){var e=i.segments.resetSegments(t);i.splits.usesSegments()&&(e||s)&&(s=!1,a.emit(a.SDK_SEGMENTS_ARRIVED))}return function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return(r?new Promise((function(t){u(r),t()})):so(n,c,o).then((function(t){c=!1,u(t)}))).catch((function(r){return r instanceof Qr||setTimeout((function(){throw r}),0),c&&n.startup.retriesOnFailureBeforeReady>e?(e+=1,co.warn("Retrying download of segments #".concat(e,". Reason: ").concat(r)),t(e)):(c=!1,!1)}))}}(t),s=$i(u,e.scheduler.segmentsRefreshRate);i.on(i.SDK_SPLITS_ARRIVED,(function(){if(!l)return;var t=n.usesSegments();t!==s.isRunning()&&(uo.info("Turning segments data polling ".concat(t?"ON":"OFF",".")),t?s.start():s.stop())})),n.usesSegments()?i.once(i.SDK_SPLITS_ARRIVED,f):setTimeout(f,0);var c=!1;function u(t){return c=!0,a(0,t).then((function(t){return c=!1,t}))}var l=!1;function f(){t.get(t.constants.READY,!0)||n.usesSegments()||o.emit(o.SDK_SEGMENTS_ARRIVED)}return{start:function(){l=!0,n.usesSegments()&&s.start()},stop:function(){l=!1,s.stop()},isRunning:function(){return l},isSynchronizingMySegments:function(){return c},synchronizeMySegments:u}},fo=Object(s.b)("splitio-producer:updater"),ho=function(t){var e=t.get(t.constants.SETTINGS),n=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.getAll(),r=n[t.constants.SETTINGS],i=n[t.constants.READINESS],a=n[t.constants.STORAGE],s=n[t.constants.COLLECTORS],c=i.splits,u=!0,l=!0;return function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;function i(i){ro.debug("Spin up split update using since = ".concat(i));var o=eo(r,i,u,s,e).then((function(t){u=!1;var e=io(t.splits);return ro.debug("New splits ".concat(e.added.length)),ro.debug("Removed splits ".concat(e.removed.length)),ro.debug("Segment names collected ".concat(e.segments)),Promise.all([a.splits.setChangeNumber(t.till),a.splits.addSplits(e.added),a.splits.removeSplits(e.removed),a.segments.registerSegments(e.segments)]).then((function(){(i!==t.till||l)&&(l=!1,c.emit(c.SDK_SPLITS_ARRIVED))}))})).catch((function(e){return e instanceof Qr||(setTimeout((function(){throw e}),0),u=!1),ro.warn("Error while doing fetch of Splits. ".concat(e)),u&&r.startup.retriesOnFailureBeforeReady>n?(n+=1,ro.info("Retrying download of splits #".concat(n,". Reason: ").concat(e)),t(n)):(u=!1,!1)}));return u&&a.splits.checkCache()&&c.emit(c.SDK_SPLITS_CACHE_LOADED),o}var f=a.splits.getChangeNumber();return(o(f)?f:Promise.resolve(f)).then(i)}}(t),r=$i(s,e.scheduler.featuresRefreshRate),i=lo(t),a=!1;function s(){return a=!0,n().then((function(t){return a=!1,t}))}return{start:function(){fo.info("Starting BROWSER producer"),r.start(),i.start()},stop:function(){fo.info("Stopping BROWSER producer"),r.stop(),i.stop()},isRunning:r.isRunning,isSynchronizingSplits:function(){return a},synchronizeSplits:s,isSynchronizingMySegments:i.isSynchronizingMySegments,synchronizeMySegments:i.synchronizeMySegments}},po=Object(s.b)("splitio-sync:sync-manager");var go=Object(s.b)("splitio-client:cleanup"),vo="unload",mo=function(){function t(e){Object(ct.a)(this,t),this.storage=e.get(e.constants.STORAGE),this.settings=e.get(e.constants.SETTINGS),this.flushData=this.flushData.bind(this),this.settings.sync.impressionsMode===V&&(this.impressionsCounter=e.get(e.constants.IMPRESSIONS_COUNTER))}return Object(ut.a)(t,[{key:"start",value:function(){"undefined"!==typeof window&&window.addEventListener&&(go.debug("Registering flush handler when unload page event is triggered."),window.addEventListener(vo,this.flushData))}},{key:"stop",value:function(){"undefined"!==typeof window&&window.removeEventListener&&(go.debug("Deregistering flush handler when unload page event is triggered."),window.removeEventListener(vo,this.flushData))}},{key:"flushData",value:function(){this._flushImpressions(),this._flushEvents(),this.impressionsCounter&&this._flushImpressionsCount()}},{key:"_flushImpressions",value:function(){var t=this.storage.impressions;if(!t.isEmpty()){var e=this.settings.url("/testImpressions/beacon"),n=ai(t,this.settings),r={sim:this.settings.sync.impressionsMode===V?V:Q};this._sendBeacon(e,n,r)||ri(ii(this.settings,{body:JSON.stringify(n)})),t.clear()}}},{key:"_flushImpressionsCount",value:function(){var t={pf:si(this.impressionsCounter)};if(0!==t.pf.length){var e=this.settings.url("/testImpressions/count/beacon");this._sendBeacon(e,t)||ri(oi(this.settings,{body:JSON.stringify(t)}))}}},{key:"_flushEvents",value:function(){var t=this.storage.events;if(!t.isEmpty()){var e=this.settings.url("/events/beacon"),n=t.toJSON();this._sendBeacon(e,n)||vi(mi(this.settings,{body:JSON.stringify(n)})),t.clear()}}},{key:"_sendBeacon",value:function(t,e,n){if("undefined"!==typeof navigator&&navigator.sendBeacon){var r={entries:e,token:this.settings.core.authorizationKey,sdk:this.settings.version};n&&i()(r,n);var o=JSON.stringify(r);return navigator.sendBeacon(t,o)}return!1}}]),t}(),yo={};var bo=function(t,e,n){var r,o=!!n,s=t.get(t.constants.SETTINGS),c=t.get(t.constants.READINESS),u=t.get(t.constants.STORAGE),f=t.get(t.constants.STATUS_MANAGER),h=c.gate,p=c.splits,g=c.segments,d=h.SDK_READY,v=o?void 0:di(t),m=o?void 0:bi(t),y=o?void 0:new mo(t);switch(s.mode){case F:case P:t.put(t.constants.COLLECTORS,v&&v.collectors),o?r=yo[s.core.authorizationKey].shared(t):(r=function(t){var e={},n=t.get(t.constants.SETTINGS),r=l(!1,t),i=n.streamingEnabled?Vi(t,e):void 0,o=t.get(t.constants.PRODUCER);function s(){o.isRunning()?po.info("Streaming couldn't connect. Continue periodic fetch of data."):(po.info("Streaming not available. Starting periodic fetch of data."),Object(a.d)(e,(function(t){t.get(t.constants.PRODUCER).start()})))}function c(){o.isRunning()&&(po.info("PUSH (re)connected. Syncing and stopping periodic fetch of data."),Object(a.d)(e,(function(t){t.get(t.constants.PRODUCER).stop()}))),u()}function u(){t.get(t.constants.PRODUCER).synchronizeSplits(),Object(a.d)(e,(function(t){t.get(t.constants.PRODUCER).synchronizeMySegments()}))}function l(t,n){var r=t?lo(n):ho(n),l=n.get(n.constants.SETTINGS),f=Object(a.q)(xt(l.core.key));return n.put(n.constants.PRODUCER,r),e[f]&&po.warn("A client with the same user key has already been created. Only the new instance will be properly synchronized."),e[f]=n,{start:function(){i?(t?o.isRunning()?r.start():r.synchronizeMySegments():(u(),i.on(Ci,c),i.on(Di,s)),i.startNewClient(f,n)):r.start()},stop:function(){e[f]&&(delete e[f],i&&(i.removeClient(f),t||i.stop()),r.isRunning()&&r.stop())}}}return r.shared=l.bind(null,!0),r}(t),yo[s.core.authorizationKey]=r);break;case K:t.put(t.constants.READY_FROM_CACHE,!0)}if(e&&r&&!o){var b=e.sdkReadyTracker,S=e.splitsReadyTracker,T=e.segmentsReadyTracker;b.setCollectorForTask(v.collectors),h.once(d,b),p.once(p.SDK_SPLITS_ARRIVED,S),g.once(g.SDK_SEGMENTS_ARRIVED,T)}r&&r.start(),v&&v.start(),m&&t.put(t.constants.EVENTS,m)&&m.start(),t.put(t.constants.COLLECTORS,n);var E=i()(Object.create(f),Gr(t),{destroy:function(){return r&&r.stop(),v&&v.stop(),m&&m.stop(),Promise.all([v&&v.flush(),m&&m.flush()]).then((function(){c.destroy(),y&&y.stop(),u.destroy&&u.destroy(),t.put(t.constants.DESTROYED,!0),o||(l(s.core.authorizationKey),delete yo[s.core.authorizationKey])}))}});return!o&&y.start(E.destroy),{api:E,metricCollectors:v&&v.collectors}};function So(t){var e=t.treatment;return t.keys?{conditionType:"WHITELIST",matcherGroup:{combiner:"AND",matchers:[{keySelector:null,matcherType:"WHITELIST",negate:!1,whitelistMatcherData:{whitelist:Object(a.j)(t.keys)?[t.keys]:t.keys}}]},partitions:[{treatment:e,size:100}],label:"whitelisted ".concat(e)}:{conditionType:"ROLLOUT",matcherGroup:{combiner:"AND",matchers:[{keySelector:null,matcherType:"ALL_KEYS",negate:!1}]},partitions:[{treatment:e,size:100}],label:"default rule"}}var To={emptyMock:1};function Eo(t){var e=Object.keys(t);return e.length!==Object.keys(To).length?(To=t,!0):e.some((function(e){var n,r,i=!To[e],o=(n=To[e],r=t[e],Object(Ne.a)(n)!==Object(Ne.a)(r)||("string"===typeof n?n!==r:n.treatment!==r.treatment||n.config!==r.config)),a=i||o;return a&&(To=t),a}))}var Oo=function(t){var e=t.features||{};if(!Eo(e))return!1;var n={};return Object(a.d)(e,(function(t,e){var r=t,i=null;Object(a.i)(t)&&(r=t.treatment,i=t.config||i);var o={};null!==i&&(o[r]=i),n[e]={conditions:[So({treatment:r})],configurations:o}})),n},_o=Object(s.b)("splitio-producer:offline");var ko=function(t,e){var n=e.getAll(),r=n[e.constants.SETTINGS],i=n[e.constants.READINESS],o=n[e.constants.STORAGE];return function(){var e=[],n=null,s={};try{s=t(r)}catch(t){n=t,_o.error("There was an issue loading the mock Splits data, no changes will be applied to the current cache. ".concat(t))}return!n&&s?(_o.debug("Splits data: "),_o.debug(JSON.stringify(s)),Object(a.d)(s,(function(t,n){e.push([n,JSON.stringify({name:n,status:"ACTIVE",killed:!1,trafficAllocation:100,defaultTreatment:"control",conditions:t.conditions||[],configurations:t.configurations,trafficTypeName:t.trafficTypeName})])})),Promise.all([o.splits.flush(),o.splits.addSplits(e)]).then((function(){i.splits.emit(i.splits.SDK_SPLITS_ARRIVED),i.segments.emit(i.segments.SDK_SEGMENTS_ARRIVED)}))):Promise.resolve()}}.bind(null,Oo),No=function(t){var e=t.get(t.constants.SETTINGS),n=ko(t);return $i(n,e.scheduler.offlineRefreshRate)};var Ao=function(t,e){var n=!e,r=t.get(t.constants.READINESS),o=t.get(t.constants.STORAGE),a=t.get(t.constants.STATUS_MANAGER);n&&setTimeout((function(){r.gate.emit(r.gate.SDK_READY)}),0);var s=n?void 0:No(t);return s&&s.start(),{api:i()(Object.create(a),Gr(t),{destroy:function(){return s&&s.stop(),r.destroy(),o.destroy&&o.destroy(),t.put(t.constants.DESTROYED,!0),!n&&l(),Promise.resolve()}}),metricCollectors:!1}};function Ro(t,e){var n=!1,r=!1;var i=function t(i){var o=new Promise((function(t,n){return i.then(t,(function(t){r?n(t):e(t)}))})),a=o.then;return o.then=function(e,i){var s=a.call(o,e,i);return"function"===typeof e&&(n=!0),"function"===typeof i?(r=!0,s):t(s)},o}(t);return i.hasOnFulfilled=function(){return n},i}var wo=Object(s.b)(""),Io="newListener",Co="removeListener";function jo(t){wo.error(t)}function Do(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t.get(t.constants.READINESS).gate,r=0,o=!1,a=!1,s=n.SDK_READY,c=n.SDK_READY_FROM_CACHE,u=n.SDK_UPDATE,l=n.SDK_READY_TIMED_OUT;n.on(Co,(function(t){t===s&&r--})),n.on(Io,(function(t){t!==s&&t!==l||(o?wo.error("A listener was added for ".concat(t===s?"SDK_READY":"SDK_READY_TIMED_OUT"," on the SDK, which has already fired and won't be emitted again. The callback won't be executed.")):t===s&&r++)}));var f=h();function h(){var i=Ro(new Promise((function(c,u){n.once(s,(function(){r!==e||i.hasOnFulfilled()||wo.warn("No listeners for SDK Readiness detected. Incorrect control treatments could have been logged if you called getTreatment/s while the SDK was not yet ready."),t.put(t.constants.READY,!0),o=!0,c()})),n.once(l,(function(e){t.put(t.constants.HAS_TIMEDOUT,!0),a=!0,u(e)}))})),jo);return i}return n.once(c,(function(){wo.info("Split SDK is ready from cache."),t.put(t.constants.READY_FROM_CACHE,!0)})),i()(Object.create(n),{Event:{SDK_READY:s,SDK_READY_FROM_CACHE:c,SDK_UPDATE:u,SDK_READY_TIMED_OUT:l},ready:function(){return a?o?Promise.resolve():Ro(Promise.reject("Split SDK has emitted SDK_READY_TIMED_OUT event."),jo):f},__context:t})}var Lo="splitio-ga-to-split",Mo=Lo+":mapper",Po=Object(s.b)(Lo);var Fo,Ko=(Fo={eventTypeId:{event:"eventAction",social:"socialAction"},eventValue:{event:"eventValue",timing:"timingValue"},eventProperties:{pageview:["page"],screenview:["screenName"],event:["eventCategory","eventLabel"],social:["socialNetwork","socialTarget"],timing:["timingCategory","timingVar","timingLabel"],exception:["exDescription","exFatal"]}},function(t){var e=t.get("hitType"),n=t.get(Fo.eventTypeId[e]||"hitType"),r=t.get(Fo.eventValue[e]),i={},o=Fo.eventProperties[e];if(o)for(var a=0;a<o.length;a++)i[o[a]]=t.get(o[a]);return{eventTypeId:n,value:r,properties:i,timestamp:Date.now()}});var xo=/^[^a-zA-Z0-9]+/,Uo=/[^-_.:a-zA-Z0-9]+/g;var Go=function(t,e,n){var r={prefix:"ga",identities:n.key&&n.trafficType?[{key:n.key,trafficType:n.trafficType}]:void 0};!function(t,e){var n=window.GoogleAnalyticsObject||"ga";window[n]=window[n]||function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];(window[n].q=window[n].q||[]).push(e)},window[n]("provide",t,e)}("splitTracker",(function n(o,s){Object(ct.a)(this,n);var c=i()({},r,t,s);this.tracker=o;var u,l=(u=c.identities,Array.isArray(u)?Object(a.r)(u).filter((function(t){if(!t)return!1;var e=t.key,n=t.trafficType;return!(!Object(a.j)(e)&&!Object(a.l)(e))&&!!Object(a.j)(n)})):[]);if(0!==l.length){var f=l.length-c.identities.length;f&&Po.warn("".concat(f," identities were discarded because they are invalid or duplicated. Identities must be an array of objects with key and trafficType.")),c.identities=l,Object(a.j)(c.prefix)||(Po.warn("The provided `prefix` was ignored since it is invalid. Please check that you are passing a string object as `prefix`."),c.prefix=void 0);var h=o.get("sendHitTask");o.set("sendHitTask",(function(t){if(h(t),!1!==c.hits&&!t.get("splitHit")){try{if(c.filter&&!c.filter(t))return}catch(t){return void Po.warn("GaToSplit custom filter threw: ".concat(t))}var n=Ko(t);if(c.mapper){try{n=c.mapper(t,n)}catch(t){return void Po.warn("GaToSplit custom mapper threw: ".concat(t))}if(!n)return}c.prefix&&(n.eventTypeId="".concat(c.prefix,".").concat(n.eventTypeId)),n.eventTypeId=function(t){if(!Object(a.j)(t)||0===t.length)return t;var e=t.replace(xo,"").replace(Uo,"_"),n=e.slice(0,80);return n.length<e.length&&Po.warn("EventTypeId was truncated because it cannot be more than 80 characters long."),n}(n.eventTypeId),function(t){return!!g(t.eventTypeId,Mo)&&!1!==v(t.value,Mo)&&!1!==O(t.properties,Mo).properties&&!(t.timestamp&&!Object(a.l)(t.timestamp))&&(!t.key||!1!==N(t.key,Mo))&&(!t.trafficTypeName||!1!==Z(t.trafficTypeName,Mo))}(n)&&(n.key&&n.trafficTypeName?e.events.track(n):c.identities.forEach((function(t){var r=i()({key:t.key,trafficTypeName:t.trafficType},n);e.events.track(r)})))}})),Po.info("Started GA-to-Split integration")}else Po.warn("No valid identities were provided. Please check that you are passing a valid list of identities or providing a traffic type at the SDK configuration.")}))},Ho=Object(s.b)("splitio-split-to-ga"),Wo=function(){function t(e){if(Object(ct.a)(this,t),"function"!==typeof t.getGa())return Ho.warn("`ga` command queue not found. No hits will be sent."),{};this.trackerNames=t.defaultTrackerNames,e&&("function"===typeof e.filter&&(this.filter=e.filter),"function"===typeof e.mapper&&(this.mapper=e.mapper),Array.isArray(e.trackerNames)&&(this.trackerNames=Object(a.s)(e.trackerNames)),this.impressions=e.impressions,this.events=e.events),Ho.info("Started Split-to-GA integration")}return Object(ut.a)(t,null,[{key:"defaultMapper",value:function(t){var e=t.type,n=t.payload;switch(e){case Y:return{hitType:"event",eventCategory:"split-impression",eventAction:"Evaluate "+n.impression.feature,eventLabel:"Treatment: "+n.impression.treatment+". Targeting rule: "+n.impression.label+".",nonInteraction:!0};case q:return{hitType:"event",eventCategory:"split-event",eventAction:n.eventTypeId,eventValue:n.value,nonInteraction:!0}}return null}},{key:"getGa",value:function(){return"undefined"!==typeof window?window[window.GoogleAnalyticsObject||"ga"]:void 0}},{key:"validateFieldsObject",value:function(t){return!(!t||!t.hitType)||(Ho.warn("your custom mapper returned an invalid FieldsObject instance. It must be an object with at least a `hitType` field."),!1)}}]),Object(ut.a)(t,[{key:"queue",value:function(e){var n=t.getGa();if(n){if(!1===this.impressions&&e.type===Y)return;if(!1===this.events&&e.type===q)return;var r;try{if(this.filter&&!this.filter(e))return;if(r=t.defaultMapper(e),this.mapper&&(!(r=this.mapper(e,r))||!t.validateFieldsObject(r)))return}catch(t){return void Ho.warn("SplitToGa queue method threw: ".concat(t,". No hit was sent."))}this.trackerNames.forEach((function(t){var e=t?"".concat(t,".send"):"send";r.splitHit=!0,n(e,r)}))}}}]),t}();Wo.defaultTrackerNames=[""];var Bo=Wo,Yo=function(t){var e=t.get(t.constants.SETTINGS),n=[];if(e.integrations.forEach((function(r){var i;switch(r.type){case W:var o=t.get(t.constants.STORAGE),a=e.core;i=Go(r,o,a);break;case B:i=new Bo(r)}i&&i.queue&&n.push(i)})),0!==n.length)return{handleImpression:function(t){n.forEach((function(e){return e.queue({type:Y,payload:t})}))},handleEvent:function(t){n.forEach((function(e){return e.queue({type:q,payload:t})}))}}},qo=function(){function t(){Object(ct.a)(this,t),this.cache={}}return Object(ut.a)(t,[{key:"_makeKey",value:function(t,e){return"".concat(t,"::").concat(jr(e))}},{key:"inc",value:function(t,e,n){var r=this._makeKey(t,e),i=this.cache[r];this.cache[r]=i?i+n:n}},{key:"popAll",value:function(){var t={};return i()(t,this.cache),this.cache={},t}},{key:"size",value:function(){return Object.keys(this.cache).length}}]),t}(),zo=Object(s.b)("splitio"),Qo=function(t,e){return"".concat(t.matchingKey?t.matchingKey:t,"-").concat(t.bucketingKey?t.bucketingKey:t,"-").concat(void 0!==e?e:"")};function Vo(t){var e={},n={splitsReadyTracker:Fe.start(Fe.TaskNames.SPLITS_READY),segmentsReadyTracker:Fe.start(Fe.TaskNames.SEGMENTS_READY),sdkReadyTracker:Fe.start(Fe.TaskNames.SDK_READY)},r=new Ee,i=Se(t);r.put(r.constants.SETTINGS,i),function(t){var e=!1;void 0==t?c.error("Factory instantiation: you passed a null or undefined api_key, api_key must be a non-empty string."):Object(a.j)(t)?t.length>0?e=t:c.error("Factory instantiation: you passed an empty api_key, api_key must be a non-empty string."):c.error("Factory instantiation: you passed an invalid api_key, api_key must be a non-empty string."),e&&(u[e]?(c.warn("Factory instantiation: You already have ".concat(u[e]," ").concat(1===u[e]?"factory":"factories"," with this API Key. We recommend keeping only one instance of the factory at all times (Singleton pattern) and reusing it throughout your application.")),u[e]++):(u[e]=1,Object.keys(u).length>1&&c.warn("Factory instantiation: You already have an instance of the Split factory. Make sure you definitely want this additional instance. We recommend keeping only one instance of the factory at all times (Singleton pattern) and reusing it throughout your application.")))}(i.core.authorizationKey);var o=te(),l=o(i.startup.readyTimeout);r.put(r.constants.READINESS,l);var f=Do(r);r.put(r.constants.STATUS_MANAGER,f);var h=Wt(r);r.put(r.constants.STORAGE,h);var p=new qo;r.put(r.constants.IMPRESSIONS_COUNTER,p);var g=Yo(r);r.put(r.constants.INTEGRATIONS_MANAGER,g);var d=i.mode===M?Ao:bo,v=d(r,n),m=v.api,y=v.metricCollectors,b=st(h.splits,r),S=Oe(i.core.key),T=Qo(S,i.core.trafficType);return e[T]=m,zo.info("New Split SDK instance created."),{client:function(t,n){if(void 0===t)return zo.debug("Retrieving default SDK client."),m;if("function"!=typeof h.shared)throw"Shared Client not supported by the storage mechanism. Create isolated instances instead.";var a,s=N(t,"Shared Client instantiation");if(!1===s)throw"Shared Client needs a valid key.";if(void 0!==n&&!1===(a=Z(n,"Shared Client instantiation")))throw"Shared Client needs a valid traffic type or no traffic type at all.";var c=Qo(s,a);if(e[c])zo.debug("Retrieving existing SDK client.");else{var u=i.overrideKeyAndTT(s,a),l=new Ee,f=o(u.startup.readyTimeout);l.put(r.constants.READY_FROM_CACHE,r.get(r.constants.READY_FROM_CACHE,!0)),l.put(r.constants.READINESS,f),l.put(r.constants.STATUS_MANAGER,Do(l,-1)),l.put(r.constants.SETTINGS,u),l.put(r.constants.STORAGE,h.shared(u)),l.put(r.constants.IMPRESSIONS_COUNTER,p),e[c]=d(l,!1,y).api,zo.info("New shared client instance created.")}return e[c]},manager:function(){return zo.info("Manager instance retrieved."),b},Logger:s.a,settings:i}}},2789:function(t,e,n){"use strict";var r,i="object"===typeof Reflect?Reflect:null,o=i&&"function"===typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};r=i&&"function"===typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!==t};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(t,e){return new Promise((function(n,r){function i(n){t.removeListener(e,o),r(n)}function o(){"function"===typeof t.removeListener&&t.removeListener("error",i),n([].slice.call(arguments))}m(t,e,o,{once:!0}),"error"!==e&&function(t,e,n){"function"===typeof t.on&&m(t,"error",e,n)}(t,i,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function u(t){if("function"!==typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function f(t,e,n,r){var i,o,a;if(u(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),a=o[e]),void 0===a)a=o[e]=n,++t._eventsCount;else if("function"===typeof a?a=o[e]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=l(t))>0&&a.length>i&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=a.length,console&&console.warn}return t}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=h.bind(r);return i.listener=n,r.wrapFn=i,i}function g(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"===typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):v(i,i.length)}function d(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function v(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function m(t,e,n,r){if("function"===typeof t.on)r.once?t.once(e,n):t.on(e,n);else{if("function"!==typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function i(o){r.once&&t.removeEventListener(e,i),n(o)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(t){if("number"!==typeof t||t<0||a(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");c=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!==typeof t||t<0||a(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=i[t];if(void 0===c)return!1;if("function"===typeof c)o(c,this,e);else{var u=c.length,l=v(c,u);for(n=0;n<u;++n)o(l[n],this,e)}return!0},s.prototype.addListener=function(t,e){return f(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return f(this,t,e,!0)},s.prototype.once=function(t,e){return u(e),this.on(t,p(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,p(this,t,e)),this},s.prototype.removeListener=function(t,e){var n,r,i,o,a;if(u(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0===--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!==typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,a||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},s.prototype.listeners=function(t){return g(this,t,!0)},s.prototype.rawListeners=function(t){return g(this,t,!1)},s.listenerCount=function(t,e){return"function"===typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},3014:function(t,e,n){"use strict";function r(t){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.d(e,"a",(function(){return r}))},312:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return h}));var r=n(4042),i=n(4043),o=n(350),a=function(t){return!!Object(o.b)(r.a,(function(e){return t===e}))},s={showLevel:!0,displayAllErrors:!1},c=!1;"undefined"!==typeof t&&"undefined"!==typeof t.version&&t.version&&(c=!0);var u=String(c?t.env.SPLITIO_DEBUG:Object(i.a)()?localStorage.getItem("splitio_debug"):""),l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new r.b(t,Object(o.k)(e,s))},f=l("splitio-utils:logger"),h={enable:function(){Object(r.c)(r.a.DEBUG)},setLogLevel:function(t){a(t)?Object(r.c)(t):f.error("Invalid Log Level - No changes to the logs will be applied.")},disable:function(){Object(r.c)(r.a.NONE)},LogLevel:r.a};/^(enabled?|on)/i.test(u)?h.enable(r.a.DEBUG):a(u)?h.setLogLevel(u):h.disable(),e.b=l}).call(this,n(117))},350:function(t,e,n){"use strict";n.d(e,"o",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return c})),n.d(e,"j",(function(){return u})),n.d(e,"l",(function(){return l})),n.d(e,"m",(function(){return f})),n.d(e,"t",(function(){return p})),n.d(e,"i",(function(){return g})),n.d(e,"k",(function(){return d})),n.d(e,"s",(function(){return v})),n.d(e,"r",(function(){return m})),n.d(e,"q",(function(){return y})),n.d(e,"p",(function(){return b})),n.d(e,"d",(function(){return S})),n.d(e,"g",(function(){return T})),n.d(e,"f",(function(){return E})),n.d(e,"n",(function(){return O})),n.d(e,"h",(function(){return _}));var r=n(3014);function i(t,e){return!(!u(t)||!u(e))&&t.slice(0,e.length)===e}function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!(!u(t)||!u(e))&&(n&&(t=t.toLowerCase(),e=e.toLowerCase()),t.slice(t.length-e.length)===e)}function a(t,e,n){var r=n;try{var i=e.split("."),o=t;i.forEach((function(t){return o=o[t]})),"undefined"!==typeof o&&(r=o)}catch(t){}return r}function s(t,e){if(Array.isArray(t)&&"function"===typeof e)for(var n=0;n<t.length;n++)if(!0===e(t[n],n,t))return n;return-1}function c(t,e){var n;if(g(t))for(var r=Object.keys(t),i=0;i<r.length&&!n;i++){var o=r[i];e(t[o],o,t)&&(n=t[o])}else if(Array.isArray(t))for(var a=0;a<t.length&&!n;a++){e(t[a],a,t)&&(n=t[a])}return n}function u(t){return"string"===typeof t||t instanceof String}function l(t){return t instanceof Number&&(t=t.valueOf()),"number"===typeof t&&(Number.isFinite?Number.isFinite(t):isFinite(t))}function f(t){return t instanceof Number&&(t=t.valueOf()),t!==t}var h=-1;function p(){return h++}function g(t){return t&&"object"===Object(r.a)(t)&&t.constructor===Object}function d(t,e){var n=t;g(e)&&Object.keys(e).forEach((function(t){var r=e[t];g(r)&&(r=n[t]&&g(n[t])?d({},n[t],r):d({},r)),void 0!==r&&(n[t]=r)}));for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];if(i&&i.length){var a=i.splice(0,1)[0];n=d.apply(void 0,[n,a].concat(i))}return n}function v(t){var e={};return t.filter((function(t){return!Object.prototype.hasOwnProperty.call(e,t)&&(e[t]=!0)}))}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON.stringify,n={};return t.filter((function(t){var r=e(t);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)}))}function y(t){if(null==t)return"";if("string"===typeof t)return t;if(Array.isArray(t))return t.map((function(t){return u(t)?t:""}))+"";var e=t+"";return"0"===e&&1/t===Number.NEGATIVE_INFINITY?"-0":e}function b(t){if("number"===typeof t)return t;if(g(t)&&"function"===typeof t.valueOf){var e=t.valueOf();t=g(e)?e+"":e}return"string"!==typeof t?0===t?t:+t:+(t=t.replace(/^\s+|\s+$/g,""))}function S(t,e){return Object.keys(t).forEach((function(n){return e(t[n],n,t)})),t}function T(t,e){var n={};if(Array.isArray(t)&&u(e))for(var r=0;r<t.length;r++){var i=t[r][e];u(i)&&(n[i]||(n[i]=[]),n[i].push(t[r]))}return n}function E(t){return t.name?t.name:(t.toString().match(/function (.+?)\(/)||["",""])[1]}function O(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=t[e[r]];return n}function _(t){return!0===t||!1===t}},4042:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return f}));var r=n(524),i=n(556),o=n(423),a=n.n(o),s={DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR",NONE:"NONE"},c=s.DEBUG,u=function(t){c=t},l={showLevel:!0,displayAllErrors:!1},f=function(){function t(e,n){Object(r.a)(this,t),this.category=e,this.options=a()({},l,n)}return Object(i.a)(t,[{key:"debug",value:function(t){this._shouldLog(s.DEBUG)&&this._log(s.DEBUG,t)}},{key:"info",value:function(t){this._shouldLog(s.INFO)&&this._log(s.INFO,t)}},{key:"warn",value:function(t){this._shouldLog(s.WARN)&&this._log(s.WARN,t)}},{key:"error",value:function(t){(this.options.displayAllErrors||this._shouldLog(s.ERROR))&&this._log(s.ERROR,t)}},{key:"_log",value:function(t,e){this._generateLogMessage(t,e)}},{key:"_generateLogMessage",value:function(t,e){var n="";return this.options.showLevel&&(n+="["+t+"]"+(t===s.INFO||t===s.WARN?" ":"")+" "),this.category&&(n+=this.category+" => "),n+e}},{key:"_shouldLog",value:function(t){var e=c,n=Object.keys(s).map((function(t){return s[t]}));return n.indexOf(t)>=n.indexOf(e)}}]),t}()},4043:function(t,e,n){"use strict";function r(){var t="__SPLITSOFTWARE__";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return!1}}n.d(e,"a",(function(){return r}))},423:function(t,e,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,s,c=a(t),u=1;u<arguments.length;u++){for(var l in n=Object(arguments[u]))i.call(n,l)&&(c[l]=n[l]);if(r){s=r(n);for(var f=0;f<s.length;f++)o.call(n,s[f])&&(c[s[f]]=n[s[f]])}}return c}},461:function(t,e,n){"use strict";function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"a",(function(){return r}))},4738:function(t,e){function n(e){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?(t.exports=n=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=n=function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),n(e)}t.exports=n,t.exports.default=t.exports,t.exports.__esModule=!0},4739:function(t,e,n){t.exports=n(4740)},4740:function(t,e,n){var r,i;void 0===(i="function"===typeof(r=function(){"use strict";Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var t={MAX_CODEPOINT:1114111,encodeUTF8:function(t,e){var n=null;for("number"===typeof t&&(n=t,t=function(){return null});null!==n||null!==(n=t());)n<128?e(127&n):n<2048?(e(n>>6&31|192),e(63&n|128)):n<65536?(e(n>>12&15|224),e(n>>6&63|128),e(63&n|128)):(e(n>>18&7|240),e(n>>12&63|128),e(n>>6&63|128),e(63&n|128)),n=null},decodeUTF8:function(t,e){for(var n,r,i,o,a=function(t){t=t.slice(0,t.indexOf(null));var e=Error(t.toString());throw e.name="TruncatedError",e.bytes=t,e};null!==(n=t());)if(0===(128&n))e(n);else if(192===(224&n))null===(r=t())&&a([n,r]),e((31&n)<<6|63&r);else if(224===(240&n))(null===(r=t())||null===(i=t()))&&a([n,r,i]),e((15&n)<<12|(63&r)<<6|63&i);else{if(240!==(248&n))throw RangeError("Illegal starting byte: "+n);(null===(r=t())||null===(i=t())||null===(o=t()))&&a([n,r,i,o]),e((7&n)<<18|(63&r)<<12|(63&i)<<6|63&o)}},UTF16toUTF8:function(t,e){for(var n,r=null;null!==(n=null!==r?r:t());)n>=55296&&n<=57343&&null!==(r=t())&&r>=56320&&r<=57343?(e(1024*(n-55296)+r-56320+65536),r=null):e(n);null!==r&&e(r)},UTF8toUTF16:function(t,e){var n=null;for("number"===typeof t&&(n=t,t=function(){return null});null!==n||null!==(n=t());)n<=65535?e(n):(e(55296+((n-=65536)>>10)),e(n%1024+56320)),n=null},encodeUTF16toUTF8:function(e,n){t.UTF16toUTF8(e,(function(e){t.encodeUTF8(e,n)}))},decodeUTF8toUTF16:function(e,n){t.decodeUTF8(e,(function(e){t.UTF8toUTF16(e,n)}))},calculateCodePoint:function(t){return t<128?1:t<2048?2:t<65536?3:4},calculateUTF8:function(t){for(var e,n=0;null!==(e=t());)n+=e<128?1:e<2048?2:e<65536?3:4;return n},calculateUTF16asUTF8:function(e){var n=0,r=0;return t.UTF16toUTF8(e,(function(t){++n,r+=t<128?1:t<2048?2:t<65536?3:4})),[n,r]}},e=String.fromCharCode;return t.arraySource=function(t){if(!Array.isArray(t))throw TypeError("Illegal argument: "+typeof t);var e=0;return function(){return e>=t.length?null:t[e++]}},t.arrayDestination=function(t){if(!Array.isArray(t))throw TypeError("Illegal argument: "+typeof t);return Array.prototype.push.bind(t)},t.stringSource=function(t){if("string"!==typeof t)throw TypeError("Illegal argument: "+typeof t);var e=0;return function(){return e>=t.length?null:t.charCodeAt(e++)}},t.stringDestination=function(){var t=[],n=[];return function(){if(0===arguments.length)return n.join("")+e.apply(String,t);t.length+arguments.length>1024&&(n.push(e.apply(String,t)),t.length=0),Array.prototype.push.apply(t,arguments)}},t.assertCharCode=function(t){if("number"!==typeof t||t!==t)throw TypeError("Illegal char code: "+typeof t);if(t<0||t>65535)throw RangeError("Illegal char code: "+t);return t},t.assertCodePoint=function(e){if("number"!==typeof e||e!==e)throw TypeError("Illegal code point: "+typeof e);if(e<0||e>t.MAX_CODEPOINT)throw RangeError("Illegal code point: "+e);return e},t.fromCodePoint=function(e){var n,r=0,i=arguments,o=i.length;return t.UTF8toUTF16((function(){return r<o?t.assertCodePoint(i[r++]):null}),n=t.stringDestination()),n()},t.codePointAt=function(e,n){if("string"!==typeof e&&!(e&&e instanceof String)||"number"!==typeof n)throw TypeError("Illegal arguments: "+typeof e+", "+typeof n);var r,i;if(!(n<0||n>=(r=e.length)))return t.UTF16toUTF8((function(){return"undefined"===typeof i&&n<r?e.charCodeAt(n++):null}),(function(t){i=t})),i},t.polyfill=function(e){return String.fromCodePoint&&!e||(String.fromCodePoint=t.fromCodePoint),String.prototype.codePointAt&&!e||(String.prototype.codePointAt=function(e){return t.codePointAt(this,e)}),t},t})?r.call(e,n,e,t):r)||(t.exports=i)},524:function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return r}))},556:function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,"a",(function(){return i}))},888:function(t,e,n){"use strict";function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}n.d(e,"a",(function(){return r}))}}]);
//# sourceMappingURL=https://miro.com/app/static/vendor~SplIO~ac104870.a71568f15a2ed7ec5c04.js.map